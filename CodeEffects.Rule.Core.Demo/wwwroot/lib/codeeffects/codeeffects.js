/* CodeEffects.com | Script version: 5.0.2.6 | Released: June 24, 2018 */

window || (this.window = this); window.CodeEffects || (window.CodeEffects = { typeName: "CodeEffects", getName: function () { return "CodeEffects" }, __namespace: !0 }); CodeEffects.register || (CodeEffects.register = function (b) { var l = window; b = b.split("."); for (var d = 0; d < b.length; d++){ var n = b[d], m = l[n]; m || (m = l[n] = { typeName: b.slice(0, d + 1).join("."), __namespace: !0 }, m.getName = function () { return this.typeName }); l = m } }); CodeEffects.register("CodeEffects.Rule.Client"); CodeEffects.register("CodeEffects.Rule.Models"); CodeEffects.register("CodeEffects.Rule.Menu");
CodeEffects.register("CodeEffects.Rule.Calendar");CodeEffects.register("CodeEffects.Rule.Time");CodeEffects.register("CodeEffects.Rule.TextBox");CodeEffects.register("CodeEffects.Rule.Common");var $rule=CodeEffects.Rule;$rule.Models.RuleModel=function(){};$rule.Models.OperatorType={String:0,Numeric:1,Date:2,Time:3,Bool:4,Enum:6,Collection:8,None:16};$rule.Common.ValueInputType={Fields:0,User:2,All:4};$rule.Client.Element=function(){};$rule.Client.FunctionType={Name:0,Param:1,Comma:2,End:3,None:4};
$rule.Client.InputType={Field:0,Input:1,None:2};$rule.Client.CalculationType={Field:0,LeftParenthesis:1,RightParenthesis:2,Multiplication:3,Division:4,Addition:6,Subtraction:7,Number:8,None:9,Function:10};$rule.Client.CollectionType={Value:0,Reference:2,Generic:4,None:8};$rule.Client.SelectionType={Exists:0,DoesNotExist:1,None:2};
$rule.Client.ElementType={Flow:0,Field:1,Function:2,Operator:3,Value:4,Clause:6,Action:7,LeftParenthesis:8,RightParenthesis:9,LeftBracket:10,RightBracket:11,Calculation:12,Tab:13,NewLine:15,HtmlTag:16,Setter:17,LeftSource:18,RightSource:19,Where:20,Exists:22};$rule.Client.type={IE:0,Chrome:1,Firefox:2,Opera:3,Other:4};$rule.Client.browser=null;$rule.Client.version=Object.hasOwnProperty.call(window,"ActiveXObject")&&!window.ActiveXObject?11:0;
11==$rule.Client.version||navigator.appName&&-1<navigator.appName.toLowerCase().indexOf("explorer")||-1<navigator.userAgent.indexOf(" MSIE ")?($rule.Client.browser=$rule.Client.type.IE,11!=$rule.Client.version&&($rule.Client.version=parseFloat(navigator.userAgent.match(/MSIE (\d+\.\d+)/)[1]))):-1<navigator.userAgent.toLowerCase().indexOf(" firefox/")?$rule.Client.browser=$rule.Client.type.Firefox:-1<navigator.userAgent.toLowerCase().indexOf(" applewebkit/")?$rule.Client.browser=$rule.Client.type.Chrome:
navigator.appName&&-1<navigator.appName.toLowerCase().indexOf("opera")||-1<navigator.userAgent.toLowerCase().indexOf("opera/")?$rule.Client.browser=$rule.Client.type.Opera:$rule.Client.browser=$rule.Client.type.Other;if($rule.Client.browser==$rule.Client.type.IE&&9>$rule.Client.version)throw Error("Your browser is not supported by Code Effects rules engine (CE482)");$rule.defined=function(b){return null!=b&&"undefined"!=typeof b&&"NaN"!=String(b)};
$rule.isNumeric=function(b){return!isNaN(parseFloat(b))&&isFinite(b)};$rule.isInteger=function(b){return $rule.isNumeric(b)&&0===b%1};$rule.text=function(b,l){if(!b.tagName)return null;if($rule.defined(l))$rule.defined(document.getElementsByTagName("BODY")[0].innerText)?b.innerText=l.toString():b.textContent=l.toString();else return $rule.defined(document.getElementsByTagName("BODY")[0].innerText)?b.innerText:b.textContent};
$rule.trim=function(b){return $rule.defined(b)&&0!==b.length?b.replace(/^\s+|\s+$/g,""):b};$rule.encode=function(b){return $rule.defined(b)?String(b).replace(/&/g,"&amp;").replace(/ /g,"&nbsp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;"):b};$rule.decode=function(b){return!$rule.defined(b)||4>b.length?b:String(b).replace(/&#39;/g,"'").replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&quot;/g,'"').replace(/&nbsp;/g," ").replace(/&amp;/g,"&")};
$rule.highlight=function(b){b.style.backgroundColor="#ffff91"};$rule.dim=function(b){b.style.backgroundColor=""};$rule.getElementWidth=function(b){return b.offsetWidth&&0<b.offsetWidth?b.offsetWidth:b.style.pixelWidth&&0<b.style.pixelWidth?b.style.pixelWidth:b.style.posWidth&&0<b.style.posWidth?b.style.posWidth:b.style.width&&0<b.style.width.length?parseInt(b.style.width.substr(0,b.style.width.length-2)):0};
$rule.getElementHeight=function(b){return $rule.defined(b.offsetHeight)&&0<b.offsetHeight?b.offsetHeight:$rule.defined(b.style.pixelHeight)&&0<b.style.pixelHeight?b.style.pixelHeight:$rule.defined(b.style.posHeight)&&0<b.style.posHeight?b.style.posHeight:$rule.defined(b.style.height)&&0<b.style.height.length?parseInt(b.style.height.substr(0,b.style.height.length-2),10):50};
$rule.getWindowDimensions=function(){var b=0,l=0;self.innerHeight?(b=window.innerHeight,l=window.innerWidth):document.documentElement&&document.documentElement.clientHeight?(b=document.documentElement.clientHeight,l=document.documentElement.clientWidth):document.body&&(b=document.body.clientHeight,l=document.body.clientWidth);return{height:parseInt(b,10),width:parseInt(l,10)}};
$rule.getScrollWidth=function(){var b=window.pageXOffset||document.body.scrollLeft||document.documentElement.scrollLeft;return b?b:0};$rule.getScrollHeight=function(){var b=window.pageYOffset||document.body.scrollTop||document.documentElement.scrollTop;return b?b:0};
$rule.position=function(b,l){var d=$rule.getBounds(b),n=$rule.getBounds(l),m=$rule.getWindowDimensions(),q=$rule.getScrollHeight(),p=$rule.getScrollWidth();l.style.top=m.height>d.y-q+d.height+n.height?d.y+d.height+"px":m.height-n.height+q-4+"px";l.style.left=m.width>d.x-p+d.width+n.width?d.x+d.width+6+"px":m.width-n.width+p-4+"px"};
$rule.leftAlign=function(b,l){var d=$rule.getBounds(b),n=$rule.getBounds(l),m=$rule.getWindowDimensions(),q=$rule.getScrollWidth();l.style.left=m.width>d.x-q+d.width+n.width?d.x+"px":m.width-n.width+q-4+"px"};$rule.getType=function(b){if(!$rule.defined(b.constructor))throw Error("CL1");b=String(b.constructor).match(/function\s+(\w+)/);return $rule.defined(b)?b[1]:"undefined"};$rule.getDocument=function(b){b=b.ownerDocument||b.document||b;return b.defaultView||b.parentWindow};
$rule.getStyle=function(b){if(3===b.nodeType)return null;var l=$rule.getDocument(b);b.documentElement&&(b=b.documentElement);var d=l&&b!==l&&l.getComputedStyle?l.getComputedStyle(b,null):b.currentStyle||b.style;if(!d&&$rule.Client.browser==$rule.Client.type.Chrome&&b.style){d=b.style.display;var n=b.style.position;b.style.position="absolute";b.style.display="block";l=l.getComputedStyle(b,null);b.style.display=d;b.style.position=n;d={};if(l)for(b=0;b<l.length;b++)d[b]=l[b];d.display="none"}return d};
$rule.getParentById=function(b,l){return $rule.defined(b)?b.id&&b.id==l?b:b.parentNode?$rule.getParentById(b.parentNode,l):null:null};$rule.getParentByTagName=function(b,l,d){$rule.defined(d)||(d=0);return 0<d&&b.tagName&&b.tagName==l?b:b.parentNode?$rule.getParentByTagName(b.parentNode,l,++d):null};
$rule.getChildrenByTagName=function(b,l,d){var n=[];if(b.childNodes)for(var m=0;m<b.childNodes.length;m++){var q=b.childNodes[m];q.tagName&&q.tagName==l&&n.push(q);if(d&&q.childNodes&&0<q.childNodes.length){q=$rule.getChildrenByTagName(q,l,d);for(var p=0;p<q.length;p++)n.push(q[p])}}return n};
$rule.getChildrenByAttribute=function(b,l,d){var n=[];if(b.childNodes)for(var m=0;m<b.childNodes.length;m++){var q=b.childNodes[m];if(q.tagName&&q.getAttribute){var p=q.getAttribute(l);!p||$rule.defined(d)&&p!=d||n.push(q)}if(q.childNodes&&0<q.childNodes.length)for(q=$rule.getChildrenByAttribute(q,l,d),p=0;p<q.length;p++)n.push(q[p])}return n};
$rule.StringBuilder=function(){var b=[];this.append=function(l){l=$rule.defined(l)?$rule.getType(l)!=$rule.getType(new String)?String(l):l:"";0<l.length&&(b[b.length]=l)};this.dump=function(){return b.join("")}};$rule.Point=function(b,l){this.x=b;this.y=l};
switch($rule.Client.browser){case $rule.Client.type.Chrome:$rule.getPosition=function(b){if(b.window&&b.window===b||9===b.nodeType)return new $rule.Point(0,0);for(var l=0,d=0,n=null,m,q=b;q;n=m,q=q.offsetParent){m=$rule.getStyle(q);var p=q.tagName?q.tagName.toUpperCase():null;!q.offsetLeft&&!q.offsetTop||"BODY"===p&&n&&"absolute"===n.position||(l+=q.offsetLeft,d+=q.offsetTop)}m=(m=$rule.getStyle(b))?m.position:null;if(!m||"absolute"!==m)for(b=b.parentNode;b&&(p=b.tagName?b.tagName.toUpperCase():null,
"BODY"!==p&&"HTML"!==p&&(b.scrollLeft||b.scrollTop)&&(l-=b.scrollLeft||0,d-=b.scrollTop||0),!(m=(m=$rule.getStyle(b))?m.position:null)||"absolute"!==m);b=b.parentNode);return new $rule.Point(l,d)};break;case $rule.Client.type.Opera:$rule.getPosition=function(b){if(b.window&&b.window===b||9===b.nodeType)return new $rule.Point(0,0);for(var l=0,d=0,n=b;n;n=n.offsetParent)l+=n.offsetLeft||0,d+=n.offsetTop||0;n=(n=b.style.position)&&"static"!==n;for(b=b.parentNode;b;b=b.parentNode){var m=b.tagName?b.tagName.toUpperCase():
null;"BODY"===m||"HTML"===m||!b.scrollLeft&&!b.scrollTop||!n||"scroll"!==b.style.overflow&&"auto"!==b.style.overflow||(l-=b.scrollLeft||0,d-=b.scrollTop||0);m=b&&b.style?b.style.position:null;n=n||m&&"static"!==m}return new $rule.Point(l,d)};break;case $rule.Client.type.Firefox:$rule.getPosition=function(b){if(b.window&&b.window===b||9===b.nodeType)return new $rule.Point(0,0);for(var l=0,d=0,n=null,m=null,q,p=b;p;n=p,m=q,p=p.offsetParent){var C=p.tagName?p.tagName.toUpperCase():null;q=$rule.getStyle(p);
(p.offsetLeft||p.offsetTop)&&("BODY"!==C||m&&"absolute"===m.position)&&(l+=p.offsetLeft,d+=p.offsetTop);null!==n&&q&&("TABLE"!==C&&"TD"!==C&&"HTML"!==C&&(l+=parseInt(q.borderLeftWidth)||0,d+=parseInt(q.borderTopWidth)||0),"TABLE"!==C||"relative"!==q.position&&"absolute"!==q.position||(l+=parseInt(q.marginLeft)||0,d+=parseInt(q.marginTop)||0))}q=(q=$rule.getStyle(b))?q.position:null;if(!q||"absolute"!==q)for(b=b.parentNode;b;b=b.parentNode)if(C=b.tagName?b.tagName.toUpperCase():null,"BODY"!==C&&"HTML"!==
C&&(b.scrollLeft||b.scrollTop)&&(l-=b.scrollLeft||0,d-=b.scrollTop||0,q=$rule.getStyle(b)))l+=parseInt(q.borderLeftWidth)||0,d+=parseInt(q.borderTopWidth)||0;return new $rule.Point(l,d)};break;default:$rule.getPosition=function(b){if(b.self||9===b.nodeType)return new $rule.Point(0,0);var l={bottom:0,height:0,left:0,right:0,top:0,width:0};try{l=b.getBoundingClientRect()}catch(p){}if(!l)return new $rule.Point(0,0);var d=b.ownerDocument.documentElement,n=l.left-2+d.scrollLeft;l=l.top-2+d.scrollTop;try{var m=
b.ownerDocument.parentWindow.frameElement||null;if(m){var q="0"===m.frameBorder||"no"===m.frameBorder?2:0;n+=q;l+=q}}catch(p){}return new $rule.Point(n,l)}}$rule.getBounds=function(b){var l=$rule.getPosition(b);return{x:l.x,y:l.y,width:$rule.getElementWidth(b),height:$rule.getElementHeight(b)}};
$rule.topZindex=function(b,l){l=l||1;if(b.childNodes)for(var d=0,n,m=b.childNodes.length;d<m;d++)n=b.childNodes[d],n.tagName&&n.style&&$rule.isInteger(n.style.zIndex)&&n.style.zIndex>l&&(l=n.style.zIndex+1),0<n.childNodes.length&&(l=$rule.topZindex(n,l));return l};
$rule.Json=function(){this.serialize=function(l){var d=new $rule.StringBuilder;b(l,d,!1);return d.dump()};this.deserialize=function(b){if(!$rule.defined(b)||0==b.length)throw Error("CL2");try{return eval("("+b.replace(/\\"/g,'"')+")")}catch(d){throw Error("CL41");}};var b=function(l,d){var n;switch(typeof l){case "number":isFinite(l)?d.append(l.toString()):d.append("null");break;case "string":d.append('"');d.append(l);d.append('"');break;case "boolean":d.append(l.toString());break;case "object":if($rule.defined(l))if($rule.getType(l)==
$rule.getType([])){d.append("[");for(n=0;n<l.length;++n)0<n&&d.append(","),b(l[n],d);d.append("]")}else{var m=[],q=0;for(n in l)m[q++]=n;d.append("{");var p=!1;for(n=0;n<q;n++){var C=l[m[n]];$rule.defined(C)&&"function"!==typeof C&&(p?d.append(","):p=!0,b(m[n],d),d.append(":"),b(C,d))}d.append("}")}else d.append("null");break;default:d.append("null")}}};
$rule.formatDate=function(b,l){function d(d){return 10>d?"0"+d:d.toString()}function n(d,b){for(var c=0,e=!1,m=0,n=d.length;m<n;m++){var l=d.charAt(m);switch(l){case "'":e?b.append("'"):c++;e=!1;break;case "\\":e&&b.append("\\");e=!e;break;default:b.append(l),e=!1}}return c}function m(d){return 10>d?"00"+d:100>d?"0"+d:d.toString()}if(!l||0===l.length||"i"===l)return b.toString();l=function(d){$rule.defined(d)||(d="d");if(1==d.length)switch(d){case "F":return"dddd, MMMM dd, yyyy h:mm:ss tt";case "s":return"yyyy'-'MM'-'dd'T'HH':'mm':'ss";
case "Y":case "y":return"MMMM, yyyy";case "M":case "m":return"MMMM dd";case "d":return"M/d/yyyy";case "D":return"dddd, MMMM dd, yyyy";case "t":return"h:mm tt";case "T":return"h:mm:ss tt";default:throw Error("CL61");}return d}(l);for(var q=new $rule.StringBuilder,p,C=0,B=/dddd|ddd|dd|d|MMMM|MMM|MM|M|yyyy|yy|y|hh|h|HH|H|mm|m|ss|s|tt|t|fff|ff|f|zzz|zz|z/g;;){var G=B.lastIndex;p=B.exec(l);G=l.slice(G,p?p.index:l.length);G=n(G,q);C+=G;if(!p)break;if(1===C%2)q.append(p[0]);else switch(p[0]){case "MMMM":q.append($rule.monthNames[b.getMonth()]);
break;case "MMM":q.append($rule.abbrMonthNames[b.getMonth()]);break;case "MM":q.append(d(b.getMonth()+1));break;case "M":q.append(b.getMonth()+1);break;case "dddd":q.append($rule.dayNames[b.getDay()]);break;case "ddd":q.append($rule.abbrDayNames[b.getDay()]);break;case "dd":q.append(d(b.getDate()));break;case "d":q.append(b.getDate());break;case "yyyy":q.append(b.getFullYear());break;case "yy":q.append(d(b.getFullYear()%100));break;case "y":q.append(b.getFullYear()%100);break;case "hh":p=b.getHours()%
12;0===p&&(p=12);q.append(d(p));break;case "h":p=b.getHours()%12;0===p&&(p=12);q.append(p);break;case "HH":q.append(d(b.getHours()));break;case "H":q.append(b.getHours());break;case "mm":q.append(d(b.getMinutes()));break;case "m":q.append(b.getMinutes());break;case "ss":q.append(d(b.getSeconds()));break;case "s":q.append(b.getSeconds());break;case "tt":q.append(12>b.getHours()?"AM":"PM");break;case "t":q.append(12>b.getHours()?"A":"P");break;case "f":q.append(m(b.getMilliseconds()).charAt(0));break;
case "ff":q.append(m(b.getMilliseconds()).substr(0,2));break;case "fff":q.append(m(b.getMilliseconds()));break;case "z":p=b.getTimezoneOffset()/60;q.append((0>=p?"+":"-")+Math.floor(Math.abs(p)));break;case "zz":p=b.getTimezoneOffset()/60;q.append((0>=p?"+":"-")+d(Math.floor(Math.abs(p))));break;case "zzz":p=b.getTimezoneOffset()/60,q.append((0>=p?"+":"-")+d(Math.floor(Math.abs(p)))+":"+d(Math.abs(b.getTimezoneOffset()%60)))}}return q.dump()};
Function.addDelegate=function(b,l){return function(){return l.apply(b,arguments)}};
$rule.Event=function(b){b=b||window.event;var l=this.type=b.type.toLowerCase();this.rawEvent=b;"keypress"==l&&(this.charCode=b.charCode||b.keyCode);b.keyCode?this.keyCode=46==b.keyCode&&"keypress"!=l?127:b.keyCode:b.charCode?this.keyCode=b.charCode:"undefined"!=typeof b.which&&(this.keyCode=b.which);this.offsetY=b.pageY?b.pageY:b.clientY+document.body.scrollTop-document.body.clientTop;this.target=b.target?b.target:b.srcElement;this.ctrlKey=b.ctrlKey;this.altKey=b.altKey;this.shiftKey=b.shiftKey};
$rule.Event.prototype={preventDefault:function(){this.rawEvent.preventDefault?this.rawEvent.preventDefault():window.event&&(this.rawEvent.returnValue=!1)},stopPropagation:function(){this.rawEvent.stopPropagation?this.rawEvent.stopPropagation():window.event&&(this.rawEvent.cancelBubble=!0)}};
$rule.addHandler=function(b,l,d){b.ceEvents||(b.ceEvents={});var n=b.ceEvents[l];n||(b.ceEvents[l]=n=[]);if(b.addEventListener){var m=function(m){return d.call(b,new $rule.Event(m))};b.addEventListener(l,m,!1)}else b.attachEvent&&(m=function(){var m={};try{m=$rule.getDocument(b).event}catch(p){}return d.call(b,new $rule.Event(m))},b.attachEvent("on"+l,m));n[n.length]={handler:d,browserHandler:m}};
$rule.addHandlers=function(b,l,d){for(var n in l){var m=l[n];d&&(m=Function.addDelegate(d,m));$rule.addHandler(b,n,m)}};$rule.removeHandlers=function(b){if(b.ceEvents){var l;for(l in b.ceEvents)if(b.ceEvents.hasOwnProperty(l)){var d=b.ceEvents[l];if(d.length&&0<d.length)for(var n=0,m,q=d.length;n<q;n++)m=d[n],m.browserHandler&&(b.removeEventListener?b.removeEventListener(l,m.browserHandler):b.detachEvent&&b.detachEvent(l,m.browserHandler));delete b.ceEvents[l]}delete b.ceEvents}};
$rule.Context={controls:[],addControl:function(b,l){for(var d=0,n=$rule.Context.controls.length;d<n;d++)if($rule.Context.controls[d].id==b)throw Error("Rule Editor with specified ID already exist in the current context (CL85)");$rule.Context.controls.push(new $rule.Context.Item(b,l))},getControl:function(b){for(var l=0,d=$rule.Context.controls.length;l<d;l++)if($rule.Context.controls[l].id==b)return $rule.Context.controls[l].ref;return null},removeControl:function(b){for(var l=[],d=0,n,m=$rule.Context.controls.length;d<
m;d++)n=$rule.Context.controls[d],n.id!=b&&l.push(n);0<l.length&&($rule.Context.controls=l)},clear:function(){$rule.Context.controls=[]}};$rule.Context.Item=function(b,l){this.id=b;this.ref=l};var $ce=$rule.Context.getControl;$rule.Menu.Item=function(){this.Type=this.Name=this.ID=null};
$rule.Menu.Control=function(b,l){var d=$rule,n,m,q,p,C,B,G=null,e=!1,r=[],c=d.highlight,v=d.dim,O=d.getElementHeight,z=d.defined,P=d.Client.browser==d.Client.type.Opera;this.init=function(c,b){G=c;C=b;r=[];P?d.addHandlers(document,{keydown:D,keypress:Ea},G):d.addHandlers(document,{keydown:D},G)};this.close=function(){z(n)&&z(n.parentNode)&&n.parentNode.removeChild(n);e=!1;r=[];C&&C()};this.select=function(c){if(n)for(var d=$rule.getChildrenByTagName(n,"DIV",!1),b=0;b<d.length;b++)if(0===d[b].innerHTML.toLowerCase().lastIndexOf(c.toLowerCase(),
0)){La(d[b]);break}};this.fill=function(c,b,l,D,G){if(z(b)&&0!=b.length){e=!0;q=l;p=G;B=D;ea(c);r=[];m=-1;l=0;for(var T;l<b.length;l++)D=b[l],T=document.createElement("DIV"),T.id="ce104"+c.id+l,T.innerHTML=D.Name,n.appendChild(T),r.push(T),T.setAttribute("ce101",z(D.ID)?D.ID:""),T.setAttribute("ce102",z(D.Type)?D.Type:""),T.setAttribute("ce103",l),T.onclick=function(c){c=c||window.event;c.cancelBubble=!0;q&&q(this.getAttribute("ce101"),this.getAttribute("ce102"),this.innerHTML)},T.onmouseover=function(c){La(this);
p&&p(this.getAttribute("ce101"))},T.onmouseout=function(c){v(this)};12<b.length&&(b=O(T),z(b)&&0!=b||(b=22),n.style.height=12*b+"px");d.position(c,n);n.onclick=function(c){c=c||window.event;c.cancelBubble=!0;return!1}}else r=[]};this.alignLeft=function(c){z(n)&&z(c)&&d.leftAlign(c,n)};var D=function(c){var d=c.keyCode;if(!e||!z(n)||0==r.length)return!0;switch(d){case 13:-1<m?q&&q(r[m].getAttribute("ce101"),r[m].getAttribute("ce102"),r[m].innerHTML):B&&B();break;case 32:-1<m&&q&&q(r[m].getAttribute("ce101"),
r[m].getAttribute("ce102"),r[m].innerHTML);break;case 38:-1==m&&(m=0);if(0<=m){var b=r[m].offsetTop-n.scrollTop<r[0].clientHeight;m--;0>m&&(m=0);b&&(n.scrollTop=r[m].offsetTop);ta(r)}break;case 40:b=r[0].clientHeight,b=n.scrollTop+11*b-m*b<b,m++,m>r.length-1&&(m=r.length-1),b&&(n.scrollTop=r[m-12+1].offsetTop),ta(r)}P||8!=d&&9!=d&&13!=d&&32!=d&&33!=d&&34!=d&&35!=d&&36!=d&&38!=d&&40!=d||(c.preventDefault&&c.preventDefault(),c.stopPropagation&&c.stopPropagation())},Ea=function(c){if(e&&z(n)&&0!=r.length){var d=
c.keyCode;8!=d&&9!=d&&13!=d&&32!=d&&33!=d&&34!=d&&35!=d&&36!=d&&38!=d&&40!=d||c.preventDefault();return!1}return!0},ta=function(){Y();0!=r.length&&(c(r[m]),p&&p(r[m].getAttribute("ce101")))},La=function(d){m=parseInt(d.getAttribute("ce103"),10);Y();c(d)},ea=function(c){n=document.createElement("DIV");n.id="ce107"+c.id;n.style.backgroundColor="#fff";z(b)&&(n.className=b);n.style.position="absolute";n.style.padding="2px";n.style.overflow="auto";n.style.display="inline-block";l&&(n.style.zIndex=$rule.topZindex(document.body));
document.body.appendChild(n)},Y=function(){for(var c=0;c<r.length;c++)v(r[c])}};$rule.Time.Settings=function(b){this.us=-1<b.indexOf("t");this.h=-1<b.indexOf("h")||-1<b.indexOf("H");this.m=-1<b.indexOf("m");this.s=-1<b.indexOf("s");this.dp=this.h||this.m||this.s};
$rule.Time.Picker=function(b,l){var d=$rule,n=null,m,q,p,C,B,G=!1,e=new Date;var r=e.getHours();var c=e.getMinutes();var v=e.getSeconds();this.defaultFormat=function(){return n?n.defaultFormat():"hh:mm tt"};this.show=function(b,m,e,l,n){C=b;p=m;B=d.defined(e)?e:"hh:mm tt";G=l;d.defined(n)&&(r=n.getHours(),c=n.getMinutes(),v=n.getSeconds());O();P()};this.hide=function(){d.defined(m)&&d.defined(m.parentNode)&&m.parentNode.removeChild(m)};this.position=function(){P()};this.getId=function(){return d.defined(m)?
m.id:null};var O=function(){m=document.createElement("TABLE");m.id="ce110"+C.id;m.insertRow(-1).insertCell(-1);d.defined(b)&&(m.className=b);m.cellSpacing=0;m.cellPadding=2;m.style.position="absolute";l&&(m.style.zIndex=$rule.topZindex(document.body));q=document.createElement("TABLE");q.id="ce111"+C.id;q.setAttribute("ce108","true");q.cellSpacing=0;q.cellPadding=2;var e=q.insertRow(-1).insertCell(-1);e.style.padding="2px 6px";n=new d.Time.Control(e,B,z);n.setValue(r,c,v);m.rows[0].cells[0].appendChild(q);
document.body.appendChild(m);m.onclick=function(c){c=c||window.event;c.cancelBubble=!0;return!1}},z=function(){e=n.getRawValue();r=e.getHours();c=e.getMinutes();v=e.getSeconds();d.defined(p)&&p(n.getValue(),n.getText())},P=function(){d.defined(C)&&(d.position(C,m),G&&d.leftAlign(C,m))}};
$rule.Time.Control=function(b,l,d){function n(c,d,b){if(B.defined(c)&&B.defined(c.options)&&0!=c.options.length){for(var e=!1,m=0;m<c.options.length;m++)if(!b&&c.options[m].text==d||b&&c.options[m].value==d){c.selectedIndex=m;e=!0;break}e||(c.selectedIndex=0)}}function m(c){return B.defined(c)&&B.defined(c.options)&&-1!=c.selectedIndex?c.options[c.selectedIndex].value:null}function q(c){return B.defined(c)&&B.defined(c.options)&&-1!=c.selectedIndex?c.options[c.selectedIndex].text:null}function p(c,
d,b){var m=document.createElement("OPTION");m.text=d;m.value=b;B.Client.browser==B.Client.type.IE?c.options.add(m):c.appendChild(m)}function C(c,d,b,m){for(--d;d<b;d++){var e=d+1;p(c,m&&10>e?"0"+e:e,e)}}var B=$rule;l=B.defined(l)?l:"hh:mm tt";var G=new B.Time.Settings(l),e=function(){if(!G.h)return 0;if(G.us){var c=parseInt(m(v),10);return"AM"==m(P)?12==c?0:c:12==c?c:c+12}return parseInt(m(v),10)},r=function(c){var d=document.createElement("SELECT");d.id=c;d.style.width="44px";b.appendChild(d);C(d,
0,59,!0);return d},c=function(){var c=document.createElement("SPAN");c.innerHTML="<b>:</b>";c.style.marginLeft="2px";c.style.marginRight="2px";b.appendChild(c)},v=null,O=null,z=null,P=null;G.h&&(v=document.createElement("SELECT"),v.id="ce113"+b.id,v.style.width="44px",b.appendChild(v),G.us?(p(v,"12",12),C(v,1,11,!1)):C(v,0,23,!0));G.h&&G.m&&c();G.m&&(O=r("ce114"+b.id));G.s&&(c(),z=r("ce115"+b.id));G.h&&G.us&&(P=document.createElement("SELECT"),P.id="ce116"+b.id,P.style.width="44px",P.style.marginLeft=
"4px",b.appendChild(P),p(P,"AM","AM"),p(P,"PM","PM"));(function(){var c=document.createElement("INPUT");c.id="ce112"+b.id;c.type="button";c.style.marginLeft="4px";c.value="OK";b.appendChild(c);c.onclick=function(c){c=c||window.event;c.cancelBubble=!0;d()}})();this.defaultFormat=function(){return"hh:mm tt"};this.getRawValue=function(){return new Date("1/1/2000 "+e()+":"+(G.m?q(O):"00")+":"+(G.s?q(z):"00"))};this.getValue=function(){return B.formatDate(this.getRawValue(),"HH:mm:ss")};this.getText=function(){var c=
(G.h?q(v):"00")+":"+(G.m?q(O):"00")+":"+(G.s?q(z):"00")+(G.h&&G.us?" "+q(P):"");return B.formatDate(new Date("1/1/2000 "+c),l)};this.setValue=function(c,d,b){if(B.defined(c)&&B.defined(d)&&B.defined(b)&&0!=c.length&&0!=d.length&&0!=b.length){if(G.h)if(G.us){c=parseInt(c,10);var m=c-12;13>c?(m=0==c?12:c,n(P,"AM",!0)):n(P,"PM",!0);n(v,m,!0)}else 2>c.length?n(v,c,!0):n(v,c,!1);G.m&&(2>d.length?n(O,d,!0):n(O,d,!1));G.s&&(2>b.length?n(z,b,!0):n(z,b,!1))}else G.h&&(v.selectedIndex=0),G.m&&(O.selectedIndex=
0),G.s&&(z.selectedIndex=0),G.h&&G.us&&(P.selectedIndex=0)}};$rule.TextBox.Settings=function(b,l,d,n,m,q,p,C){this.parent=b;this.id=l;this.css=d;this.defCss=n;this.max=m;this.defVal=q;this.errVal=p;this.errColor=C};
$rule.TextBox.Control=function(){var b,l;this.init=function(d){l=d;b=document.createElement("INPUT");b.type="text";b.id=l.id;b.className=l.defCss;b.maxLength=l.max;b.value=l.defVal;l.parent.appendChild(b);b.onfocus=function(d){b.className=$rule.trim(b.className.replace(l.errColor,""));b.className=l.css;if(b.value.toLowerCase()==l.defVal.toLowerCase()||b.value.toLowerCase()==l.errVal.toLowerCase())b.value=""};b.onblur=function(d){d=$rule.trim(b.value);if(0==d.length||d.toLowerCase()==l.defVal.toLowerCase()||
d.toLowerCase()==l.errVal.toLowerCase())b.className=$rule.trim(b.className.replace(l.errColor,"")),b.value=l.defVal,b.className=l.defCss}};this.getValue=function(){return b.value};this.setValue=function(d){b.value=d};this.setClass=function(d){b.className=d}};$rule.Calendar.Css=function(){this.container="ceCal";this.header="ceHeader";this.day="ceDay";this.today="ceToday";this.selected="ceSelected";this.dayRollover="ceRollover";this.weekDays="ceDays"};
$rule.Calendar.Control=function(b,l){var d=$rule,n,m,q,p,C=!1,B=d.defined(l)?l:new d.Calendar.Css,G,e,r,c,v=new Date;var O=v.getMonth();var z=v.getFullYear();var P=v.getHours();var D=v.getMinutes();var Ea=v.getSeconds();var ta=v.getDate();var La=G=0;this.show=function(c,b,m,e,l){n=c;q=b;p=d.defined(m)?m:"MMM dd, yyyy";C=e;d.defined(l)&&(ta=l.getDate(),G=z=l.getFullYear(),La=O=l.getMonth(),P=l.getHours(),D=l.getMinutes(),Ea=l.getSeconds());Ra();ba();ea()};this.hide=function(){d.defined(c)&&d.defined(c.parentNode)&&
c.parentNode.removeChild(c)};this.position=function(){ba()};this.defaultFormat=function(){return"MMM dd, yyyy"};this.getId=function(){return d.defined(c)?c.id:null};var ea=function(){var c=d.getChildrenByTagName(e.rows[0].cells[1],"SPAN",!1);c[0].innerHTML=d.abbrMonthNames[O];c[1].innerHTML=z;Y()},Y=function(){var c=new Date,b=new Date(z,O,1),m=c.getFullYear(),e=c.getMonth();c=c.getDate();b=b.getDay();var l=1,n=!0;var q=1==O&&(0==z%4&&0!=z%100||0==z%400)?29:d.days[O];for(var v=1;v<r.rows.length;v++)for(var D=
0;D<r.rows[v].cells.length;D++){var C=r.rows[v].cells[D];n=!0;1==v&&D>=b||1<v&&l<=q?(C.innerHTML=l,m==z&&e==O&&l==c&&d.defined(B.today)?(C.className=B.today,C.setAttribute("ce117",B.today),n=!1):z==G&&O==La&&l==ta&&d.defined(B.selected)?(C.className=B.selected,C.setAttribute("ce117",B.selected),n=!1):d.defined(B.day)&&(C.className=B.day),n&&d.defined(B.day)&&C.setAttribute("ce117",B.day),C.onclick=function(c){var b=(new d.Time.Settings(p)).dp;b||(c=c||window.event,c.cancelBubble=!0);for(var m=1;m<
r.rows.length;m++)for(var e=0;e<r.rows[m].cells.length;e++)c=r.rows[m].cells[e],c.getAttribute("ce117")==B.today?c.className=B.today:(c.className=B.day,c.setAttribute("ce117",B.day));ta=parseInt(d.text(this),10);this.className!=B.today&&d.defined(B.selected)&&(this.className=B.selected,this.setAttribute("ce117",B.selected));b||oa()},C.onmouseover=function(c){d.defined(B.dayRollover)&&(this.className=B.dayRollover)},C.onmouseout=function(c){c=this.getAttribute("ce117");d.defined(c)&&(this.className=
c)},l++):(d.defined(B.day)&&(C.className=B.day),C.innerHTML="&nbsp;",C.onclick=C.onmouseover=C.onmouseout=null)}},oa=function(){var c=O+1+"/"+ta+"/"+z;v=new Date(c);O=v.getMonth();z=v.getFullYear();ta=v.getDate();La=O;G=z;if((new d.Time.Settings(p)).dp){var b=m.getRawValue();P=b.getHours();D=b.getMinutes();Ea=b.getSeconds();c+=" "+P+":"+D+":"+Ea}d.defined(q)&&q(c)},Ra=function(){c=document.createElement("TABLE");c.id="ce120"+n.id;c.setAttribute("ceCalendarControl","true");c.cellSpacing=0;c.cellPadding=
1;var l=c.insertRow(-1);l=l.insertCell(-1);d.defined(B.container)&&(c.className=B.container);c.style.position="absolute";b&&(c.style.zIndex=$rule.topZindex(document.body));e=document.createElement("TABLE");e.id="ce121"+n.id;e.setAttribute("ce118","true");d.defined(B.header)&&(e.className=B.header);e.cellSpacing=e.cellPadding=0;e.style.width="100%";var q=e.insertRow(-1),v=q.insertCell(-1);v.style.padding="3px 0px 5px 6px";var C=Ga(v,"ce123"+n.id,"&#171;&#171;");C.style.marginRight="4px";C.onclick=
function(c){c=c||window.event;c.cancelBubble=!0;--z;ea()};v=Ga(v,"ce124"+n.id,"&#171;");v.style.marginLeft="2px";v.onclick=function(c){c=c||window.event;c.cancelBubble=!0;0==O?(O=11,--z):--O;ea()};C.style.cursor=v.style.cursor="pointer";v=q.insertCell(-1);v.style.width="90px";v.style.textAlign="center";v.style.padding="3px 0px 5px 0px";C=Ga(v,"ce125"+n.id,d.abbrMonthNames[O]);v=Ga(v,"ce126"+n.id,z);C.style.marginRight="2px";v.style.marginLeft="2px";C.style.cursor=v.style.cursor="default";C=q.insertCell(-1);
C.style.padding="3px 6px 5px 0px";C.style.textAlign="right";q=Ga(C,"ce127"+n.id,"&#187;");q.style.marginRight="2px";q.onclick=function(c){c=c||window.event;c.cancelBubble=!0;11==O?(O=0,++z):++O;ea()};C=Ga(C,"ce128"+n.id,"&#187;&#187;");C.style.marginLeft="4px";C.onclick=function(c){c=c||window.event;c.cancelBubble=!0;++z;ea()};C.style.cursor=q.style.cursor="pointer";l.appendChild(e);r=Fa();document.body.appendChild(c);(new d.Time.Settings(p)).dp&&(l=c.insertRow(-1),l=l.insertCell(-1),l.style.padding=
"0 4px 6px 4px",l.style.textAlign="center",m=new d.Time.Control(l,p,oa),m.setValue(P,D,Ea))},Fa=function(){var b=document.createElement("TABLE");b.id="ce148"+n.id;b.cellSpacing=1;b.cellPadding=0;b.style.width="100%";for(var m,e,l=0;7>l;l++){m=b.insertRow(-1);for(var p=0;7>p;p++)e=m.insertCell(-1),0==l&&d.defined(B.weekDays)&&(e.className=B.weekDays),e.innerHTML="&nbsp;"}for(m=0;m<b.rows[0].cells.length;m++)b.rows[0].cells[m].innerHTML=d.abbrWeekDayNames[m];c.rows[0].cells[0].appendChild(b);return b},
Ga=function(c,b,m){var e=document.createElement("SPAN");d.defined(b)&&(e.id=b);e.innerHTML=m;c.appendChild(e);return e},ba=function(){d.defined(n)&&(d.position(n,c),C&&d.leftAlign(n,c))}};$rule.days=[31,28,31,30,31,30,31,31,30,31,30,31];$rule.dayNames="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" ");$rule.abbrDayNames="Sun Mon Tue Wed Thu Fri Sat".split(" ");$rule.abbrWeekDayNames="SMTWTFS".split("");$rule.monthNames="January February March April May June July August September October November December ".split(" ");
$rule.abbrMonthNames="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec ".split(" ");$rule.init=function(b){data=(new $rule.Json).deserialize(b&&b.d||b);$rule.defined(data.h)&&($rule.Help=data.h);$rule.Errors=data.e;$rule.Context.addControl(data.id,new $rule.Control({element:data.id,asp:!1,z:data.z}));return $ce(data.id)};
$rule.Settings=function(b){this.help=b.ui[0];this.isEval=b.ui[1];this.evalIf=b.ui[2];this.execIf=b.ui[3];this.tools=b.ui[4];this.pb=b.ui[5];this.tochki=b.ui[6];this.clicks=b.ui[7];this.titles=b.ui[8];this.right=b.ui[9];this.mode=b.ui[10];this.tId=b.ui[11];this.tUrl=b.ui[12];this.tCoId=b.ui[13];this.tCoUrl=b.ui[14];this.els=b.s;this.clientFlds=[];this.ruleCss="ceRule";this.menuCss="ceMenu";this.toolCss="ceToolBar";this.deleteCss="ceDeleteButton";this.saveButCss="ceSaveButton";this.rulesCss="ceRulesButton";
this.descCss="ceDescriptionBox";this.nameCss="ceNameBox";this.descDefCss="ceDescriptionBoxDefault";this.nameDefCss="ceNameBoxDefault";this.helpCss="ceHelp";this.timeCss="ceTime";this.flowCss="ceFlow";this.fieldCss="ceField";this.clauseCss="ceClause";this.operCss="ceOperator";this.skobkiCss="ceParenthesis";this.actionCss="ceAction";this.braceCss="ceBrace";this.valueCss=this.calcCss=this.paramCss="ceValue";this.tabCss="ceTab";this.lineCss="ceNewLine";this.currentBg="ceCurrent";this.invalidColor="ceError";
this.warningColor="ceValueWarn";this.highlightBg="ceHighlight";this.warn="ceWarn";this.selectedBg="ceSelected";this.emptyColor="ceEmpty"};
$rule.Control=function(b){var l=$rule,d,n,m,q,p,C,B,G,e=null,r,c=null,v=null,O=[],z=[],P=[],D,Ea=[],ta=null,La=null,ea,Y,oa,Ra,Fa,Ga=null,ba=!0,T,Ca,ua=null,Sa=0,wc=!1,Vb=!1,ia=null,db=!1,la=null,Ha=!1,R=!1,ja=!1,M=!1,ra=0,Wb=0,Xb=0,S=this,h=l.defined,lb=new l.Json,Ta,Yb,Eb,xc=l.getChildrenByAttribute,x=null,Fb,Ab,Bb,Zb=!1,$b=!1,mb=null,ac=null,bc=null,cc=null;if(!h(b))throw Error("Params object is expected (CL242)");var y={clientOnly:!1,container:null,form:null,field:null,id:"ceDefaultID",asp:b.asp||
!1,useZindex:b.z||!1,fieldId:b.h||null};if(h(b.element))if("string"===typeof b.element)y.id=b.element;else{if("object"!==typeof b.element)throw Error("Invalid value of the main container (CL246)");y.container=b.element;if(h(b.element.id)&&0<$rule.trim(b.element.id).length)y.id=b.element.id;else throw Error("The editor's container must have id (CL246)");}else throw Error("Pars.element value must be either a DOM element or its id (CL244)");S.loadSettings=function(a){Fb=a&&a.d||a;yc();return S};S.loadRule=
function(a){Bb=a&&a.d||a;if(h(Bb))return dc(),S};S.loadInvalids=function(a){Ab=a&&a.d||a;if(h(Ab))return ec(),S};S.setClientActions=function(a,c,d){ac=d;bc=c;cc=a;return S};S.getRuleId=function(){return ia};S.isEvaluationType=function(){return e?e.isEval:!0};S.saved=function(a){function c(a,c){return a.Name.localeCompare(c.Name)}function d(a,c){return a.n.localeCompare(c.n)}if(!y.clientOnly)return S;!h(ia)&&h(a)&&(ia=a);h(ia)&&ia!=a&&zc();var k=[],b=!1;if(e.tools){for(var m=0;m<P.length;m++)a=P[m],
"ceEval"!=a.ID&&"ceExec"!=a.ID&&(a.ID==ia&&(a.Name=ub(oa.getValue()),b=!0),k.push({ID:a.ID,Name:a.Name}));b||(a=new l.Menu.Item,a.ID=ia,a.Name=ub(oa.getValue()),k.push(a));k.sort(c);e.els.rls=k;Ac()}if(e.isEval){b=!1;for(k=0;k<x.fds.length;k++)if(a=x.fds[k],a.ir&&a.v==ia){a.n=ub(oa.getValue());b=!0;break}b||(a={n:ub(oa.getValue()),v:ia,o:4,t:1,ai:2,ir:!0,l:!1},x.fds.push(a));x.fds.sort(d)}return S};S.deleted=function(a){for(var c=[],d,k=0;k<P.length;k++)d=P[k],d.ID!=a&&c.push(d);P=c;if(e.isEval){c=
[];for(k=0;k<x.fds.length;k++)d=x.fds[k],d.v!=a&&c.push(d);x.fds=c}return S};S.extract=function(){mb="ceExtract";db=!1;return lb.serialize(Gb())};S.clear=function(){Bc();return S};S.dispose=function(){vb();Hb("ceMenu");Hb("ceTime");l.removeHandlers(window);l.removeHandlers(document);h(y.form)&&l.removeHandlers(y.form);if(h(y.container)&&!h(y.form)){var a=l.getChildrenByAttribute(document.body,"ce","form"+y.container.id);if(h(a)&&0<a.length)try{var c=a[0];document.body.removeChild(c);var d=document.getElementById(y.fieldId);
h(d)&&c.removeChild(d)}catch(k){}}return S};S.redraw=function(){Cc();return S};S.disable=function(){vb();r=9;return S};S.enable=function(){vb();return S};S.init=function(a){Fb=a;l.addHandlers(window,{load:yc},S)};S.load=function(a){h(a)&&(Bb=a,l.addHandlers(window,{load:dc},S))};S.invalid=function(a){h(a)&&(Ab=a,l.addHandlers(window,{load:ec},S))};S.valid=function(){fc();va()};S.post=function(){gc()};var yc=function(){e=new $rule.Settings(lb.deserialize(Fb));Fb=null;if(!h(e.els.src)||0==e.els.src.length)throw Error("CL87");
d=l.Client.ElementType;n=l.Client.FunctionType;B=l.Client.CollectionType;G=l.Client.SelectionType;m=l.Models.OperatorType;q=l.Client.InputType;p=l.Client.CalculationType;C=l.Common.ValueInputType;Ta=$rule.getBounds;Yb=l.Client.browser==l.Client.type.IE;Eb=l.Client.browser==l.Client.type.Opera;Xb=0;y.container=document.getElementById(y.id);y.fieldId?y.field=document.getElementById(y.fieldId):y.clientOnly=!0;N(null);h(e.els.str)&&e.els.str.length||(e.els.str=[]);e.els.ens&&0<e.els.ens.length?Dc(e.els.ens,
!0):e.els.ens=[];e.els.mds&&0<e.els.mds.length?Dc(e.els.mds,!1):e.els.mds=[];if(y.clientOnly){if(h(e.tId)&&h(e.tUrl)){var a=xc(document,e.tId);0<a.length&&(a[0].href=e.tUrl)}h(e.tCoId)&&h(e.tCoUrl)&&(a=xc(document,e.tCoId),0<a.length&&(a[0].href=e.tCoUrl))}e.els.ms=e.help&&h(l.Help)?l.Help:{};e.els.er=l.Errors;y.asp||y.clientOnly||(y.form=l.getParentByTagName(y.container,"FORM"),h(y.form)&&l.addHandlers(y.form,{submit:gc},this));a="_"+y.id;var c=document.getElementById(a);h(c)&&(c.innerHTML="");e.tools?
(Ac(),Ec(!1),e.help?Fc(y.container,!0):Gc()):e.help?Ec(!0):(ea=document.getElementById("ceT"+y.container.id),h(ea)&&ea.parentNode.removeChild(ea),ea=null);h(c)||(c=document.createElement("DIV"),c.id=a);c.className=Z(e.ruleCss);y.container.appendChild(c);y.container=c;Hc();r=2;D="";Ha=!1;Hb("ceMenu");Hb("ceTime");wc||(ua=new l.Menu.Control(e.menuCss,y.useZindex),T=new l.Calendar.Control(y.useZindex),Ca=new l.Time.Picker(e.timeCss,y.useZindex),l.addHandlers(document,{click:id},this),l.addHandlers(document,
{keydown:jd,keypress:kd,keyup:ld},this),ua.init(this,e.help?va:null),l.addHandlers(window,{resize:Cc},this),wc=!0);$b&&dc();Zb&&ec();Zb=$b=!1},dc=function(){if(h(e)){var a=lb.deserialize(Bb);if(0!=a.length){ia=a[0].g;e.isEval=a[0].v;if(e.tools){h(ia)&&zc();var g=a[0].n,t=a[0].d;h(g)&&0<g.length?(oa.setValue(nb(g)),oa.setClass(Z(e.nameCss))):(oa.setValue(nb(e.els.lbl.n)),oa.setClass(Z(e.nameDefCss)));h(t)&&0<t.length?(Ra.setValue(nb(t)),Ra.setClass(Z(e.descCss))):(Ra.setValue(nb(e.els.lbl.d)),Ra.setClass(Z(e.descDefCss)))}Sa=
a.length+1;Ic();for(var k,b,Ia=null,F=null,A=0,H=0,u,y=null,w=1;w<a.length;w++){g=a[w];if(!h(g))break;u=!1;if(g.t==d.NewLine)eb(!1,!0);else if(g.t==d.Tab)Q({t:g.t,id:null,v:"",n:"&nbsp;",st:null,ct:null,ft:null,fv:!1,it:null,h:!0});else{t=h(g.n)?g.n:null;switch(g.t){case d.Flow:b=E(e.els.fls,g.v);if(!h(b)){alert("This rule cannot be properly loaded using the current Mode");return}switch(g.v){case "if":k=e.isEval?e.evalIf:e.execIf;break;case "elseIf":k=4==e.mode?e.isEval?e.evalIf:e.execIf:b.n;break;
default:k=b.n}break;case d.LeftSource:k=e.els.lbl.ub;break;case d.RightSource:k=e.els.lbl.ue;break;case d.LeftParenthesis:k=e.els.lbl.pb;break;case d.RightParenthesis:k=e.els.lbl.pe;break;case d.LeftBracket:k=e.els.lbl.cb;break;case d.RightBracket:k=e.els.lbl.ce;break;case d.Action:case d.Function:switch(g.f){case n.Name:H=0;v=null;if(g.d)A=0,k=g.v,u=!0;else{b=E(g.t==d.Action?x.acs:x.fds,g.v);if(!h(b))throw Error("CL11");k=0<b.ps.length?b.n+"&nbsp;(":b.n;A=b.ps.length;g.t==d.Function&&(b.rt.o==m.Enum?
v=ob(b.rt.e):b.rt.o==m.Numeric&&h(b.rt.mds)?v=fb(b.rt.mds,b.ftr):b.rt.o==m.Date?Ia=b.rt.f:b.rt.o==m.Time&&(F=b.rt.f))}break;case n.Param:if(g.i==q.Field)b=E(x.fds,g.v),h(b)?k=b.n:(k=g.v,u=!0);else if(g.o==m.String)k=l.encode(l.decode(g.v));else if(g.o==m.Numeric)b=fa(c),b.ps.length>=H&&h(b.ps[H].mds)?(k=fb(b.ps[H].mds,b.ps[H].ftr),h(k)&&0<k.length?(g.i=q.Field,k=E(k,g.v),h(k)?k=k.Name:(k=g.v,u=!0)):(u=!0,k=g.v)):k=g.v;else if(g.o==m.Date)k=l.formatDate(new Date(g.v),h(g.r)?g.r:T.defaultFormat());
else if(g.o==m.Time)k=l.formatDate(new Date("1/1/2010 "+g.v),h(g.r)?g.r:Ca.defaultFormat());else if(g.o==m.Enum)k=E(ob(g.e),g.v),h(k)?k=k.Name:(k=g.v,u=!0);else if(g.o==m.Bool)k=Cb(g.v);else throw Error("CL22");H++;break;case n.Comma:k=",";break;case n.End:k=0<A?")":"&nbsp;";A=H=0;break;default:throw Error("CL36");}break;case d.Calculation:switch(g.c){case p.Function:switch(g.f){case n.Name:H=0;v=null;if(g.d)A=0,k=g.v,u=!0;else{b=E(x.fds,g.v);if(!h(b))throw Error("CL11");k=0<b.ps.length?b.n+"&nbsp;(":
b.n;A=b.ps.length;if(b.rt.o!=m.Numeric)throw Error("CL13");h(b.rt.mds)&&(v=fb(b.rt.mds,b.ftr))}break;case n.Param:if(g.i==q.Field)b=E(x.fds,g.v),h(b)?k=b.n:(k=g.v,u=!0);else if(g.o==m.String)k=l.encode(l.decode(g.v));else if(g.o==m.Numeric)b=fa(c),b.ps.length>=H&&h(b.ps[H].mds)?(k=fb(b.ps[H].mds,b.ps[H].ftr),h(k)&&0<k.length?(g.i=q.Field,k=E(k,g.v),h(k)?k=k.Name:(k=g.v,u=!0)):(u=!0,k=g.v)):k=g.v;else if(g.o==m.Date)k=l.formatDate(new Date(g.v),h(g.r)?g.r:T.defaultFormat());else if(g.o==m.Time)k=l.formatDate(new Date("1/1/2010 "+
g.v),h(g.r)?g.r:Ca.defaultFormat());else if(g.o==m.Enum)k=E(ob(g.e),g.v),h(k)?k=k.Name:(k=g.v,u=!0);else if(g.o==m.Bool)k=Cb(g.v);else throw Error("CL22");H++;break;case n.Comma:k=",";break;case n.End:k=0<A?")":"&nbsp;";A=H=0;break;default:throw Error("CL36");}break;case p.Field:b=E(x.fds,g.v);h(b)?k=b.n:(k=g.v,u=!0);break;case p.Number:k=g.v;break;case p.LeftParenthesis:k=e.els.lbl.pb;break;case p.RightParenthesis:k=e.els.lbl.pe;break;case p.Multiplication:k="&#215;";break;case p.Division:k="&#247;";
break;case p.Addition:k="&#43;";break;case p.Subtraction:k="&#150;";break;default:throw Error("CL90");}break;case d.Field:g.d?(k=g.v,v=Ia=F=null,u=!0):(b=E(x.fds,g.v),h(b)?(v=g.o==m.Enum||g.o==m.Collection&&b.co==m.Enum?h(b.e)?ob(b.e):b.ens:(g.o==m.Numeric||g.o==m.Collection&&b.co==m.Numeric)&&h(b.mds)?fb(b.mds,b.ftr):null,Ia=g.o==m.Date&&h(b.f)?b.f:null,F=g.o==m.Time&&h(b.f)?b.f:null,k=b.n):(k=g.v,v=Ia=F=null));break;case d.Exists:h(g.v)||(g.v=g.y==G.DoesNotExist?"ce803":"ce802");k=hc(g.v);break;
case d.Where:k=pb(e.els.dsc,"where");break;case d.Clause:k=E(e.els.cls,g.v);if(h(k))k=E(e.els.cls,g.v).n;else{alert("This rule cannot be properly loaded using the current Mode");return}break;case d.Setter:k=pb(e.els.str,g.v);break;case d.Operator:k=Jc(g.v,g.o);h(k)?k=k.n:(k="is",u=!0);break;case d.Value:g.o==m.Enum?h(v)&&0!=v.length?(b=E(v,g.v),h(b)?k=b.Name:(b=E(x.fds,g.v),h(b)?k=b.n:(k=g.v,u=!0))):(k="[Unknown]",u=!0):g.i==q.Field?(b=E(x.fds,g.v),h(b)?k=b.n:(k=g.v,u=!0)):g.o==m.String?k=l.encode(l.decode(g.v)):
g.o==m.Numeric?h(v)&&0<v.length?(g.i=q.Field,k=E(v,g.v),h(k)?k=k.Name:(k=g.v,u=!0)):k=g.v:k=g.o==m.Date?l.formatDate(new Date(g.v),h(Ia)?Ia:T.defaultFormat()):g.o==m.Time?l.formatDate(new Date("1/1/2010 "+g.v),h(F)?F:Ca.defaultFormat()):Cb(g.v)}Q({t:g.t,id:t,v:g.v,n:k,st:g.o,ct:g.c,co:g.co,cn:g.cn,ft:g.f,it:g.i,h:!0,fv:g.q});g.t!=d.LeftSource&&g.t!=d.RightSource||N(c);gb(g.t,g.o,g.c,g.i)&&wa();u&&(c.className=c.className+" "+Z(e.warn),y=e.els.er.e107)}}v=Bb=null;r=0;vb();h(y)&&alert(y)}}else $b=!0},
ec=function(){if(h(e)){var a=lb.deserialize(Ab);if(0!=a.length){a[0].e&&h(oa)&&(oa.setValue(e.els.er.e104),oa.setClass(Z(e.nameCss)+" "+Z(e.invalidColor)));for(var c=1;c<a.length;c++){var d=a[c],k=document.getElementById(d.c||d.ClientID);h(k)&&(k.className=k.className+" "+e.highlightBg,k.title=d.h||d.Hint,O.push(k.id))}e.help&&(1<a.length?(hb(e.els.er.e102),Y.className=Y.className+" "+Z(e.invalidColor)):a[0].e&&(hb(e.els.er.e103),Y.className=Y.className+" "+Z(e.invalidColor)));Ab=null}}else Zb=!0},
gc=function(){y.clientOnly||(db=!1,y.field.value=lb.serialize(Gb()))},Gb=function(){if(0<l.getChildrenByTagName(y.container,"INPUT",!1).length)qb(e.els.er.e114);else{N(null);var a=Ma(),c=!1,b=new l.Models.RuleModel;b.Elements=[];h(ia)&&(b.Id=ia);b.IsLoadedRuleOfEvalType=e.isEval;b.Command=mb;b.Mode=e.mode;if(!db){if(e.tools){var k=oa.getValue();b.Name=0==l.trim(k).length||l.trim(k).toLowerCase()==e.els.lbl.n.toLowerCase()||l.trim(k).toLowerCase()==e.els.er.e104.toLowerCase()?null:ub(k);k=Ra.getValue();
b.Desc=0==l.trim(k).length||l.trim(k).toLowerCase()==e.els.lbl.d.toLowerCase()||l.trim(k).toLowerCase()==e.els.er.e104.toLowerCase()?null:ub(k);b.SkipNameValidation=!1}else b.SkipNameValidation=!0;for(var J=0;J<a.length;J++){var p=a[J];var F=w(p);if(h(F)&&F!=d.HtmlTag){k=new l.Client.Element;k.Type=F;k.Name=p.id;k.Oper=ha(p,!0);k.FuncType=K(p);k.InpType=za(p);k.CalType=V(p);switch(F){case d.Field:k.Value=p.getAttribute("ce208");k.IsRule="true"==p.getAttribute("ce213");F=E(x.fds,k.Value);c=h(F)&&h(F.mds);
switch(k.Oper){case m.String:h(F)&&(k.Max=F.max);break;case m.Numeric:h(F)&&(k.Dec=F.dec,k.Cal=F.cal,k.Min=F.min,k.Max=F.max,h(F.mds)&&(k.InpType=q.Input,c=!0));break;case m.Date:case m.Time:h(F)&&(k.Format=F.f);break;case m.Enum:h(F)&&(k.En=F.e);break;case m.Collection:if(h(F)&&(k.CollType=F.ct,F.ct==B.Value))switch(F.co){case m.String:k.Max=F.max;break;case m.Numeric:k.Dec=F.dec;k.Cal=F.cal;k.Min=F.min;k.Max=F.max;F.co==m.Numeric&&h(F.mds)&&(k.InpType=q.Input,c=!0);break;case m.Date:case m.Time:k.Format=
F.f;break;case m.Enum:k.En=F.e}}break;case d.LeftSource:N(p);k.Value=p.getAttribute("ce208");break;case d.RightSource:N(p);k.Value=p.getAttribute("ce208");break;case d.Value:k.Value=$rule.decode(p.getAttribute("ce206"));k.Oper==m.Numeric&&c&&(F=E(x.fds,k.Value),h(F)||(k.InpType=q.Input));c=!1;break;case d.Calculation:h(p.getAttribute("ce206"))&&(k.Value=$rule.decode(p.getAttribute("ce206")));break;case d.Action:case d.Function:if(F==d.Function&&k.FuncType==n.Name)k.Value=p.getAttribute("ce208"),k.IsFuncValue=
"true"==p.getAttribute("ce216"),F=E(x.fds,k.Value),c=h(F)&&h(F.rt.mds);else if(k.FuncType==n.Param){var A=p;F=k.Oper;var r=fa(A);var u=null;h(r)&&(A=Wa(A),u=0<=A&&r.ps.length>=A&&r.ps[A].o==F?r.ps[A]:Kc(r,F,0>A?0:A));r=u;if(k.InpType==q.Input){if(h(r))switch(k.Oper){case m.String:k.Max=r.max;break;case m.Numeric:k.Dec=r.dec;k.Min=r.min;k.Max=r.max;break;case m.Date:case m.Time:k.Format=r.f;break;case m.Enum:k.En=r.e}h(p.getAttribute("ce206"))&&(k.Value=$rule.decode(p.getAttribute("ce206")))}else k.Value=
p.getAttribute("ce208"),F=E(x.fds,k.Value),h(r)&&r.o==m.Numeric&&h(r.mds)&&!h(F)&&(k.InpType=q.Input)}else k.Value=p.getAttribute("ce208"),F==d.Function&&(k.IsFuncValue="true"==p.getAttribute("ce216"),E(x.fds,k.Value));break;case d.Exists:case d.Where:switch(p.getAttribute("ce208")){case "ce803":k.SelType=G.DoesNotExist;break;default:k.SelType=G.Exists}F=Xa(p,d.Field);h(F)?(F=E(x.fds,F.getAttribute("ce208")),h(F)?k.CollType=F.ct:k.CollType=B.Generic):k.CollType=B.Generic;k.Value=p.getAttribute("ce208");
break;default:k.Value=p.getAttribute("ce208")}b.Elements.push(k)}}}return b}},od=function(a){function g(a){sa(a)?Ua(a):c=I(a)}function b(a){a=ic(c,n.End);h(a)&&(c=I(a),$a())}function k(a,g){var k=Ja(c),b=null;if(k&&(b=ca(a.previousSibling),w(b)==d.Function)){var t=wb(b,n.Name);if(!h(t))return;b=ca(t.previousSibling)}t=[];if(V(c)==p.Function)for(k=Ib(g),L("ce801",m.Numeric,ab(m.Numeric),t),b=0;b<k.length;b++)t.push(k[b]);else{t=ha(a,!0);b=!k||w(b)==d.Setter&&"to"==b.getAttribute("ce208");var J=E(x.fds,
g),l=h(J.ftr)?J.ftr:null;if(h(J)){J=J.t==d.Function?J.rt:J;var A=J.o;var q=J.co;var r=J.e;var F=J.mds;h(J.mds)&&(l=null);var H=J.cc;var y=J.cl;var v=J.cv;var D=[];if(h(J)&&"true"==c.getAttribute("ce216")){var z=J.t==d.Function?J.rt.ai:J.ai,G=J.t==d.Function?J.rt.o:J.o;(G==m.Numeric&&J.t==d.Function?J.rt.cal:J.cal)&&L("C",G,e.els.lbl.c,D);z==C.All&&L("ce801",G,ab(G),D)}for(J=0;J<x.fds.length;J++)z=x.fds[J],z.ir&&k||k&&h(z.st)&&!z.st||z.ir&&(h(ia)&&z.v==ia||t!=m.Bool)||z.v==g||(G=h(z.ftr)?z.ftr:null,
z.t==d.Function?b&&(z.rt.o!=t||A==m.Enum&&r!=z.rt.e||z.mds!=F||null!=l&&"any"!=l&&l!=G&&"any"!=G||D.push(z)):A==m.Collection&&z.o==m.Collection?z.ct==B.Reference&&z.cc==H&&z.cl==y&&z.cv==v?D.push(z):z.ct!=B.Value||z.co!=q||q==m.Enum&&r!=z.e||z.mds!=F||D.push(z):z.o!=t||A==m.Enum&&r!=z.e||z.mds!=F||null!=l&&"any"!=l&&l!=G&&"any"!=G||D.push(z));t=D}else t=[]}0<t.length?(R=!0,u(t,a,Ia,null)):Ja(c)||(ja=!1,k=E(x.fds,g),h(k)&&(k.t==d.Function?0<k.ps.length?(c=I(a),Va(k)):xb(k):k.o==m.Collection&&k.ct!=
B.Value||u(bb(k),a,Ya,null)))}function J(a,g){for(var d=[],k,b=0;b<x.acs.length;b++)k=x.acs[b],k.v!=g&&d.push(k);1<d.length||1==d.length&&d[0].v!=g?(R=!0,u(d,a,F,null)):(ja=!1,d=Jb(),0<d.length&&u(d,c,Kb,null))}function Ia(a,g){var k="true"==c.getAttribute("ce216"),t=V(c)==p.Function;w(c)==d.Function||w(c)==d.Calculation&&K(c)==n.Name?b(a):M=!0;if("ce801"==a)switch(parseInt(g,10)){case m.Numeric:Na({t:t?d.Calculation:d.Value,v:"",st:m.Numeric,ct:t?p.Number:p.None,ft:n.None,span:c});break;default:Db(ca(c))}else if("C"==
a)jc(a);else{var h=E(x.fds,a);h.t==d.Function?yb({t:t?d.Calculation:h.t,m:a,v:k}):t?ma(p.Field,a):k?Lc(h,a,t):(cb(h,null),!W()||Ja(c)||h.o==m.Collection&&h.ct!=B.Value||u(bb(h),c,Ya,null))}}function F(a){b(a);yb({t:E(x.acs,a).t,m:a,v:!1})}if(9==r)return!1;M=R=ja=Ha=!1;var A=a.target;if(h(l.getParentById(A,y.container.id))){N(c);(h(c)&&A.id!=c.id&&"INPUT"==c.tagName||"INPUT"!=A.tagName)&&wa();ra=0;if(6==r||8==r)ua.close(),r=Mc()?0:2;if(4==r)ib(),r=0;else if(3==r)jb(),r=0;else if(2==r||1==r&&!h(c))Ic(),
Q({t:d.Flow,id:null,v:"if",n:e.isEval?e.evalIf:e.execIf,st:null,ct:null,ft:null,it:null,h:!1,fv:!1}),c=I(c),u(na(),c,pa,d.LeftParenthesis);else{if(a.ctrlKey)return"true"==A.getAttribute("ce218")?(A.className=l.trim(A.className.replace(e.selectedBg,"")),A.setAttribute("ce218","false")):(A.className=l.trim(A.className)+" "+e.selectedBg,A.setAttribute("ce218","true")),A=l.getChildrenByAttribute(y.container,"ce218","true"),0<A.length?va("i137"):va(),!1;Lb();var H=!0;if(h(A.getAttribute("ce202"))){if(0==
r&&"INPUT"==A.tagName)return!0;a=V(A);var v=za(A),D=ha(A,!0);gb(w(A),D,a,v)&&v!=q.Field?Na({t:w(A),v:A.getAttribute("ce206"),st:D,ct:a,ft:K(A),span:A,pi:Wa(c)}):g(A)}else{wa();H=!1;A=Ma();D=!1;for(var G=l.Client.browser==l.Client.type.IE&&9>l.Client.version?l.getScrollHeight():0,z=0;z<A.length;z++){if(!h(A[z].nextSibling)){g(A[z]);D=!0;break}v=Ta(w(A[z].nextSibling)==d.HtmlTag?A[z].nextSibling.nextSibling:A[z].nextSibling);if(v.y>a.offsetY+G){g(A[z]);D=!0;break}}!D&&0<A.length&&g(A[A.length-1])}ja=
e.clicks&&h(c)&&H&&!h(c.getAttribute("ce207"));N(c);aa();r=0;if(ja)switch(H=c.getAttribute("ce208"),w(c)){case d.Flow:"else"==H?u(Oa(),c,Pa,null):u(na(),c,pa,d.LeftParenthesis);break;case d.Function:switch(K(c)){case n.Param:H=fa(c);M=R=!0;Va(H);break;case n.Name:k(c,H);break;case n.End:sa(c)&&k(c.previousSibling,H)}break;case d.Field:k(c,H);break;case d.LeftParenthesis:case d.LeftSource:u(na(),c,pa,d.LeftParenthesis);break;case d.RightParenthesis:case d.RightBracket:case d.RightSource:u(X(),c,U,
d.RightParenthesis);break;case d.Action:switch(K(c)){case n.Param:H=fa(c);M=R=!0;Va(H);break;case n.Name:J(c,H);break;case n.End:sa(c)&&J(c.previousSibling,H)}break;case d.Setter:"set"==H?u(rb(),c,sb,null):Qa(ca(c));break;case d.LeftBracket:u(Aa(),c,ma,null);break;case d.Calculation:a=[];switch(V(c)){case p.LeftParenthesis:M=R=!1;u(Aa(),c,ma,null);break;case p.RightParenthesis:M=R=!1;u(Aa(),c,ma,null);break;case p.Function:switch(K(c)){case n.Name:k(c,H);break;case n.End:sa(c)&&k(c.previousSibling,
H)}break;case p.Field:Nc(H);break;case p.Addition:L(p.Subtraction,null,"&#150;",a);L(p.Multiplication,null,"&#215;",a);L(p.Division,null,"&#247;",a);M=R=!0;u(a,c,ma,null);break;case p.Subtraction:L(p.Addition,null,"&#43;",a);L(p.Multiplication,null,"&#215;",a);L(p.Division,null,"&#247;",a);M=R=!0;u(a,c,ma,null);break;case p.Multiplication:L(p.Addition,null,"&#43;",a);L(p.Subtraction,null,"&#150;",a);L(p.Division,null,"&#247;",a);M=R=!0;u(a,c,ma,null);break;case p.Division:L(p.Addition,null,"&#43;",
a),L(p.Subtraction,null,"&#150;",a),L(p.Multiplication,null,"&#215;",a),M=R=!0,u(a,c,ma,null)}break;case d.Operator:a=Da(c);h(a)&&(a=E(x.fds,a.getAttribute("ce208")),h(a)&&(a=bb(a,H),h(a)&&0<a.length?(M=R=!0,u(a,c,Ya,null)):(ja=!1,"isNull"==H||"isNotNull"==H?u(X(),c,U,d.RightParenthesis):Qa(ca(c)))));break;case d.Clause:"then"==H?u(Oa(),c,Pa,null):Ja(c)?u(Oa(),c,Pa,null):(H=md(H),h(H)&&0<H.length?(M=R=!0,u(H,c,U,null)):u(na(),c,pa,d.LeftParenthesis));break;case d.Exists:a=[];switch(H){case "ce803":L("ce802",
d.Field,e.els.lbl.h,a);break;default:L("ce803",d.Field,e.els.lbl.l,a)}M=R=!0;u(a,c,nd,null);break;case d.Value:V(c)==p.Function?Nc(H):(H=ha(c,!0),M=H!=m.Date&&H!=m.Time,R=!0,Qa(ca(c)))}}va()}else 8==r?(Lb(),wa(),N(c),A.id!=Fa.id&&(ua.close(),r=1),va()):(Lb(),wa(),H=T.getId(),3==r&&null!=H&&h(l.getParentById(A,H))||vb(),h(y.container)&&h(y.container.childNodes)&&1<y.container.childNodes.length&&va("i102"));return!0},pd=function(a){if(9==r)return!1;ba=!0;M=R=ja=!1;if(1==r||2==r)return N(),!0;var g=
a.keyCode;if(16==g||17==g||18==g)return 6==r?ua.close():3==r?jb():4==r&&ib(),r=0,!0;a.ctrlKey?D="":(Lb(),N(c));if(27==g||0!=r&&(8==g||127==g))ba=!1;32==g&&0<D.length&&(D+=" ");6!=r&&8!=r||40!=g||Wb++;if((6==r||8==r)&&37!=g&&39!=g&&(38!=g||0<Wb))return!0;if(4==r||3==r){if(13==g)return!0;4==r?ib():jb();r=0}var b=w(c),k=ha(c,!0);switch(g){case 9:D="";b!=d.NewLine&&b!=d.Tab||Q({t:d.Tab,id:null,v:"",n:"&nbsp;",st:null,ct:p.None,ft:null,it:null,h:!1,fv:!1});ba=!1;break;case 13:D="";b==d.Calculation&&V(c)==
p.Number?h(c.getAttribute("ce207"))?(wa(),c=I(c),aa(),W()&&u(Aa(),c,ma,null)):a.ctrlKey&&za(c)!=q.Field?Na({t:b,v:c.getAttribute("ce206"),st:k,ct:p.Number,ft:K(c),span:c}):eb(!1):b==d.Value?k==m.String||k==m.Numeric?h(c.getAttribute("ce207"))?(wa(),c=I(c),aa(),W()&&u(X(),c,U,d.RightParenthesis)):a.ctrlKey&&za(c)!=q.Field?Na({t:b,v:c.getAttribute("ce206"),st:k,ct:V(c),ft:K(c),span:c}):eb(!1):eb(!1):b==d.Function||b==d.Action?k==m.String||k==m.Numeric?h(c.getAttribute("ce207"))?(wa(),c=I(c),aa(),Va(fa(c))):
a.ctrlKey&&za(c)!=q.Field&&Na({t:w(c),v:c.getAttribute("ce206"),st:ha(c,!0),ct:V(c),ft:K(c),span:c,pi:Wa(c)}):sa(c)?(Ua(c),eb(!1)):K(c)==n.End&&eb(!1):zb(c)&&(h(c.nextSibling)&&K(c.nextSibling)==n.End&&0==fa(c).ps.length&&(b=Mb(c),h(b)&&(c=b)),eb(!1));ba=!1;break;case 88:if(a.ctrlKey)return Oc(!0,"i139"),ba=!1;break;case 67:if(a.ctrlKey)return Oc(!1,"i138"),ba=!1;break;case 86:if(a.ctrlKey&&0<Ea.length){6==r?ua.close():3==r?jb():4==r&&ib();a=h(c)&&h(c.nextSibling);g=[];b=0;for(var e;b<Ea.length;b++)e=
Ea[b],e.id=y.container.id+Sa,Sa++,a?y.container.insertBefore(e,c.nextSibling):y.container.appendChild(e),c=I(e),g.push(c.cloneNode(!0));Ea=g;return ba=!1}break;case 34:ra=0;wa();b=Ma();c=I(b[b.length-1]);b=Ta(c);kc(b.y,b.height);sa(c)&&Ua(c);N(c);aa();ba=!1;break;case 35:ra=0;wa();b=Xa(c,d.HtmlTag);h(b)?c=I(b.previousSibling):(b=Ma(),c=I(b[b.length-1]));sa(c)&&Ua(c);N(c);aa();ba=!1;break;case 33:ra=0;wa();c=I(Ma()[0]);N(c);Nb(Ta(c).y);aa();ba=!1;break;case 36:ra=0;wa();b=lc(c,d.NewLine);if(!h(b)&&
(b=Ma()[0],"if"!=b.getAttribute("ce208")))throw Error("CL02");c=I(b);N(c);aa();ba=!1;break;case 38:6!=r&&8!=r||xa();gb(b,k,V(c),za(c))&&h(c.getAttribute("ce207"))&&(wa(),c=I(c));a.ctrlKey&&(ta=c.id);k=Ma();var l=Ta(c),F=null;0==ra&&(ra=l.x+l.width);var A=!1;for(b=k.length-1;-1<b;b--)if(A){var H=k[b];var v=w(H);if(h(F)&&(v==d.NewLine||Ka(H))){c=I(H);Nb(e.y);break}e=Ta(H);if(!(e.y>l.y-parseInt(e.height/2,10)))if(h(F)||(F=H),ra>e.x+e.width||!h(H.previousSibling)||Ta(H.previousSibling).y<e.y){c=I(H);
Nb(e.y);break}else if(v=e.x+parseInt(e.width/2,10),ra>v){Nb(e.y);c=I(H);break}}else A=k[b].id==c.id;sa(c)&&Ua(c);N(c);aa();a.ctrlKey&&(e=w(c),e==d.Flow&&Ka(c)&&(c=I(Ba(c.nextSibling)),N(c)),Ob(!1),va("i137"));ba=!1;break;case 40:gb(b,k,V(c),za(c))&&h(c.getAttribute("ce207"))&&(wa(),c=I(c));b=!1;a.ctrlKey&&(e=w(c),e==d.Flow&&Ka(c)&&(c=I(Ba(c.nextSibling)),N(c),b=!0),e=ca(c),!zb(c)&&w(e)==d.Flow&&Ka(e)&&(c=I(Ba(c.nextSibling)),N(c),b=!0),ta=c.id);if(!b){b=Ma();e=Ta(c);0==ra&&(ra=e.x+e.width);F=!1;for(H=
b.length-1;-1<H;H--){l=b[H];if(l.id==c.id)break;k=Ta(l);F||(F=k.y-e.height-parseInt(e.height/2,10)<e.y);if(F)if(A=Ta(l.previousSibling),ra>k.x+k.width||!h(A)||A.y<k.y){c=I(l);kc(k.y,k.height);break}else if(A=k.x+parseInt(k.width/2,10),ra>=A){c=I(l);kc(k.y,k.height);break}}sa(c)&&Ua(c);N(c);aa()}a.ctrlKey&&(Ob(!0),va("i137"));ba=!1;break;case 37:ra=0;ba=!1;6!=r&&8!=r||xa();if("INPUT"==c.tagName)return!1;if(h(c.previousSibling)){k=!1;b=null;if(a.ctrlKey)if(l=ca(c.previousSibling),e=w(l),e==d.Flow&&
Ka(l)){if(k=!0,h(c.nextSibling)&&(e=w(c),e==d.Tab||e==d.NewLine||e==d.HtmlTag))c=I(Ba(c.nextSibling)),N(c)}else ta=c.id;k||(h(c.previousSibling)&&(e=w(c.previousSibling),c=I(e==d.HtmlTag?c.previousSibling.previousSibling:c.previousSibling),N(c)),sa(c)&&(K(c)==n.End?Ua(c):c=I(c.previousSibling)),k=ca(c),e=w(k),a.ctrlKey&&e==d.Flow&&Ka(k)?h(c.nextSibling)&&(e=Ba(c.nextSibling),c=I(e),N(c)):N(c),aa(),a.ctrlKey&&(Ob(!1),b="i137"));va(b)}break;case 39:ra=0;ba=!1;6!=r&&8!=r||xa();if(!a.ctrlKey)if(b==d.Value&&
(k==m.String||k==m.Numeric)){if(h(c.getAttribute("ce207")))return!1;c=I(c);aa()}else if(b==d.Calculation&&za(c)==q.Input&&V(c)==p.Number){if(h(c.getAttribute("ce207")))return!1;c=I(c);aa()}else{if(!(b!=d.Function&&b!=d.Action||za(c)!=q.Input||k!=m.String&&k!=m.Numeric)){if(h(c.getAttribute("ce207")))return!1;c=I(c);aa()}}else if("INPUT"==c.tagName)return!1;if(h(c.nextSibling))if(!a.ctrlKey&&sa(c.nextSibling))Ua(c.nextSibling),N(c),aa(),xb(fa(c));else if(b=!1,a.ctrlKey&&(e=w(c),e==d.Flow&&Ka(c)&&(c=
I(Ba(c.nextSibling)),N(c),b=!0),e=ca(c),!zb(c)&&w(e)==d.Flow&&Ka(e)&&(c=I(Ba(c.nextSibling)),N(c),b=!0),ta=c.id),b||(c=w(c.nextSibling)==d.HtmlTag?I(c.nextSibling.nextSibling):I(c.nextSibling),N(c)),a.ctrlKey)Ob(!0),va("i137");else{b=w(c);e=W();if(h(c.nextSibling)||b!=d.RightBracket)if(b!=d.Function&&b!=d.Action||!e)b==d.Flow&&e?"else"==c.getAttribute("ce208")?u(Oa(),c,Pa,null):u(na(),c,pa,d.LeftParenthesis):b!=d.LeftParenthesis&&b!=d.LeftSource||!e?b!=d.RightParenthesis&&b!=d.RightSource&&b!=d.RightBracket&&
b!=d.Value||!e?b==d.Field&&e?Ja(c)||(b=c.getAttribute("ce208"),E(x.fds,b).ct!=B.Reference&&u(bb(E(x.fds,b)),c,Ya,null)):b==d.Exists&&e?u(mc(Xa(c,d.Field).getAttribute("ce208")),c,nc,null):b==d.Setter&&e?"set"==c.getAttribute("ce208")?u(rb(),c,sb,null):(Qa(ca(c)),Pc()&&u(X(),c,U,null)):b==d.Operator&&e?"isNull"==c.getAttribute("ce208")||"isNotNull"==c.getAttribute("ce208")?u(X(),c,U,d.RightParenthesis):(Qa(c,!0),Pc()&&u(X(),c,U,d.RightParenthesis)):b==d.Clause&&e?"then"==c.getAttribute("ce208")||Ja(c)?
u(Oa(),c,Pa,null):u(na(),c,pa,d.LeftParenthesis):b!=d.LeftBracket&&b!=d.Calculation||!e||u(Aa(),c,ma,null):u(X(),c,U,d.RightParenthesis):(b==d.LeftSource&&N(c),u(na(),c,pa,d.LeftParenthesis));else switch(K(c)){case n.End:xb(fa(c));break;case n.Name:b=fa(c),0<b.ps.length&&K(c.nextSibling)==n.End&&Va(b)}else u(X(),c,U,d.RightParenthesis);va()}}if(Eb)return 8==g&&a.preventDefault(),!1;if(Yb&&13==g||8==g&&!h(c.getAttribute("ce207"))||9==g||33==g||34==g||35==g||36==g||38==g||39==g||40==g)a.preventDefault&&
a.preventDefault(),a.stopPropagation&&a.stopPropagation();return ba},qd=function(a){if(9==r)return!1;var g=a.keyCode;Ha=!1;if(!ba)return ba=!0,Eb?(9!=g&&13!=g&&33!=g&&34!=g&&35!=g&&36!=g&&38!=g&&40!=g||a.preventDefault(),!1):!0;if(1==r||2==r)return!0;if((6==r||8==r)&&!qa(g)||(6==r||8==r)&&38==g)return!1;if(3!=r&&4!=r){var b=D;D="";if(8==r)32==g?(R=!0,u(P,Fa,Pb,null),r=8):qa(g)&&(D=b+=String.fromCharCode(g),R=!0,da(P,Fa,Pb,null),r=8);else{var k=ca(c);switch(w(k)){case d.Flow:"else"==k.getAttribute("ce208")?
32==g?u(Oa(),c,Pa,null):qa(g)&&(D=b+=String.fromCharCode(g),da(Oa(),c,Pa,null)):32==g?u(na(),c,pa,d.LeftParenthesis):qa(g)&&(D=b+=String.fromCharCode(g),da(na(),c,pa,d.LeftParenthesis),Ha=!0);break;case d.Function:case d.Action:if(oc(g))switch(K(k)){case n.End:if(32==g)xb(fa(k));else if(qa(g)){var l=fa(k);if(W()&&(b=l.t==d.Function?bb(l):Jb(),0<b.length)){l=l.t==d.Function?Ya:Kb;var Ia=Qc(b,D);0<Ia.length?u(Ia,c,l,null,!0):u(b,c,l,null,!1)}}break;default:if(l=ha(k,!0),!gb(w(k),l,V(k),za(k))||l!=m.String&&
l!=m.Numeric||!h(k.getAttribute("ce207")))32==g?Va(fa(k)):qa(g)&&(D=b+=String.fromCharCode(g),Va(fa(k)))}break;case d.LeftParenthesis:case d.LeftSource:32==g?u(na(),c,pa,d.LeftParenthesis):qa(g)&&(D=b+=String.fromCharCode(g),da(na(),c,pa,d.LeftParenthesis),Ha=!0);break;case d.RightSource:N(c);32==g?u(X(),c,U,d.RightParenthesis):qa(g)&&(D=b+=String.fromCharCode(g),da(X(),c,U,d.RightParenthesis));break;case d.RightParenthesis:case d.RightBracket:32==g?u(X(),c,U,d.RightParenthesis):qa(g)&&(D=b+=String.fromCharCode(g),
da(X(),c,U,d.RightParenthesis));break;case d.Exists:32==g?u(mc(Xa(c,d.Field).getAttribute("ce208")),c,nc,null):qa(g)&&(D=b+=String.fromCharCode(g),da(mc(Xa(c,d.Field).getAttribute("ce208")),c,nc,null));break;case d.Field:if(32==g&&Ja(k)){b=h(k.nextSibling)?Mb(k.nextSibling):null;b&&w(b)==d.Setter&&"to"==b.getAttribute("ce208")||(b=E(x.fds,k.getAttribute("ce208")),h(b)&&(Q({t:d.Setter,id:null,v:"to",n:pb(e.els.str,"to"),st:b.o,ct:p.None,ft:n.None,it:q.None,h:!1,fv:!1}),W()&&Qa(ca(k))));break}l=E(x.fds,
k.getAttribute("ce208"));l.ct!=B.Reference&&(l=bb(l),32==g?u(l,c,Ya,null):qa(g)&&(D=b+=String.fromCharCode(g),da(l,c,Ya,null)));break;case d.Operator:32==g?"isNull"==k.getAttribute("ce208")||"isNotNull"==k.getAttribute("ce208")?u(X(),k,U,d.RightParenthesis):Qa(k):qa(g)&&(D=b+=String.fromCharCode(g),"isNull"==k.getAttribute("ce208")||"isNotNull"==k.getAttribute("ce208")?da(X(),c,U,d.RightParenthesis):h(v)&&0<v.length?da(v,c,pc,null):h(z.ce)&&0<z.ce.length||0<z.length?da(z,c,Vb?Rc:Sc,null):Qa(k));break;
case d.Clause:32==g?"then"==k.getAttribute("ce208")||Ja(k)?u(Oa(),c,Pa,null):u(na(),c,pa,d.LeftParenthesis):qa(g)&&(l="then"==k.getAttribute("ce208")||Ja(k),D=b+=String.fromCharCode(g),da(l?Oa():na(),c,l?Pa:pa,l?null:d.LeftParenthesis),Ha=!0);break;case d.LeftBracket:32==g?u(Aa(),c,ma,null):qa(g)&&(D=b+=String.fromCharCode(g),da(Aa(),c,ma,null));break;case d.Calculation:V(k)==p.Number?oc(g)&&!h(k.getAttribute("ce207"))&&(32==g?u(Aa(),c,ma,null):qa(g)&&(D=b+=String.fromCharCode(g),da(Aa(),c,ma,null))):
32==g?u(Aa(),c,ma,null):qa(g)&&(D=b+=String.fromCharCode(g),da(Aa(),c,ma,null));break;case d.Setter:32==g?"set"==k.getAttribute("ce208")?u(rb(),c,sb,null):Qa(k):qa(g)&&(D=b+=String.fromCharCode(g),"set"==k.getAttribute("ce208")?(da(rb(),c,sb,null),Ha=!0):h(v)&&0<v.length?da(v,c,pc,null):Qa(k));break;case d.Value:if(oc(g))if(l=ha(k),l==m.String||l==m.Numeric)h(k.getAttribute("ce207"))||(32==g?u(X(),c,U,d.RightParenthesis):qa(g)&&(D=b+=String.fromCharCode(g),da(X(),c,U,d.RightParenthesis)));else if(l==
m.Numeric&&32==g)h(k.getAttribute("ce207"))||u(X(),c,U,d.RightParenthesis);else if(l==m.Date||l==m.Time||l==m.Bool||l==m.Enum)32==g?u(X(),c,U,d.RightParenthesis):qa(g)&&(D=b+=String.fromCharCode(g),da(X(),c,U,d.RightParenthesis))}}}if(Eb)return 8!=g&&9!=g&&32!=g&&33!=g&&34!=g&&35!=g&&36!=g&&38!=g&&40!=g||a.preventDefault(),!1;32==g?(a.preventDefault&&!h(k.getAttribute("ce207"))&&a.preventDefault(),a.stopPropagation&&a.stopPropagation()):(8==g||9==g)&&a.stopPropagation&&a.stopPropagation()},rd=function(a){if(9==
r)return!1;if(1==r||2==r)return!0;a=a.keyCode;if(16==a)return!1;if(8!=r){46==a&&h(c.nextSibling)&&(c=Mb(c.nextSibling));var g=w(c);var b=ha(c,!0)}switch(a){case 27:D="";if(8==r){xa();break}6==r?xa():3==r?(jb(),r=0):4==r&&(ib(),r=0);"INPUT"==c.tagName&&(wa(),c=I(c),aa());break;case 127:D="";if(8==r){xa();break}6==r&&xa();3==r?(jb(),r=0):4==r?(ib(),r=0):gb(g,b,V(c),za(c))&&h(c.getAttribute("ce207"))||(h(c.nextSibling)?w(c.nextSibling)==d.HtmlTag?Qb():g==d.NewLine?(ka(c),ka(c),h(c.nextSibling)&&(h(c.nextSibling)&&
w(c.nextSibling)==d.Tab&&Qb(),c=I(h(c.nextSibling)?c.nextSibling:c),N(c))):Ka(c)?(c=c.nextSibling,$a()):($a(),h(c.nextSibling)&&(w(c.nextSibling)==d.HtmlTag&&Qb(),c=I(h(c.nextSibling)?c.nextSibling:c),N(c))):g==d.NewLine?(ka(c),ka(c)):Ka(c)||$a(),sa(c)&&Ua(c));break;case 8:D="",8==r?xa():(6==r&&xa(),3==r?(jb(),r=0):4==r?(ib(),r=0):(gb(g,b,V(c),za(c))||(g==d.RightSource?$a():!h(c.previousSibling)||Ka(c)||Ka(c.previousSibling)||(w(c)==d.NewLine||w(c.previousSibling)==d.NewLine?(c=ca(c.previousSibling),
Qb(),c=I(h(c.nextSibling)?c.nextSibling:c),N(c)):Ka(c.previousSibling)||(c=c.previousSibling,$a(),c=I(h(c.nextSibling)?c.nextSibling:c),N(c)))),sa(c)&&(Ua(c),N(c))))}return!1},vb=function(){if(h(y)&&h(y.container)&&h(e))if(9==r)r=1;else{6==r?(ua.close(),r=1):3==r?(jb(),r=1):4==r?(ib(),r=1):0==r&&(r=1,h(c)&&h(c.getAttribute("ce207"))&&wa());Mc()||Tc();2!=r&&e.help&&hb(e.els.ms.i102);fc();D="";Ha=!1;if(h(c)&&(c.className=$rule.trim(c.className.replace(e.currentBg,"")),sa(c))){var a=wb(c,n.Name);h(a)&&
(a.className=$rule.trim(a.className.replace(e.currentBg,"")))}N(null)}},yb=function(a){var g=E(a.t==d.Action?x.acs:x.fds,a.m);Q({t:a.t==d.Calculation?a.t:g.t,id:null,v:g.v,n:0<g.ps.length?g.n+"&nbsp;(":g.n,st:g.t==d.Action?null:g.rt.o,ct:a.t==d.Calculation?p.Function:p.None,ft:n.Name,it:q.None,h:!1,fv:a.v});var b=c;Q({t:a.t==d.Calculation?a.t:g.t,id:null,v:g.v,n:0<g.ps.length?")":"&nbsp;",st:g.t==d.Action?null:g.rt.o,ct:a.t==d.Calculation?p.Function:p.None,ft:n.End,it:q.None,h:!1,fv:a.v});0<g.ps.length?
(c=I(b),W()&&Va(g)):W()&&xb(g)},Va=function(a){var g=Wa(c);if(g>=a.ps.length-1&&!M){var b=ic(c,n.End);h(b)&&(c=I(b),xb(a))}else switch(g+=1,M&&--g,b=a.ps[g],a=[],v=null,b.ai){case C.All:case C.Fields:if(b.o==m.Collection){for(var k=0;k<x.fds.length;k++){var e=x.fds[k];ja&&c.getAttribute("ce208")==e.v||e.t==d.Field&&e.o==m.Collection&&(b.ct==B.Generic?e.cg&&a.push(e):e.ct==b.ct&&e.cr==b.cr&&e.cg==b.cg&&e.cv==b.cv&&e.cl==b.cl&&a.push(e))}0<D.length?da(a,c,Za,null):u(a,c,Za,null)}else{a:{k=b.o;var l=
g;g=[];var p=Da(c);if(h(p)){e=E(x.fds,p.getAttribute("ce208"));h(e)||(e=E(x.acs,p.getAttribute("ce208")));if(!h(e)){k=g;break a}e=e.ps[l]}if(h(e)){p=h(e.ftr)?e.ftr:null;for(var A=0,q;A<x.fds.length;A++)if(l=x.fds[A],l.t==d.Field&&!l.ir&&l.o==k){if(e.o==m.Numeric){if(e.l!=l.l||l.min<e.min||l.max>e.max||l.dec!=e.dec||l.mds!=e.mds)continue}else if(e.o==m.Enum){if(e.e!=l.e||e.l!=l.l)continue}else if(e.l!=l.l)continue;q=h(l.ftr)?l.ftr:null;null!=p&&"any"!=p&&p!=q&&"any"!=q||g.push(l)}}k=g}if(0<k.length){b.ai==
C.All&&L("ce801",h(b.mds)?b.mds:b.o,ab(b.o,h(b.mds)),a);b=[];for(g=0;g<k.length;g++)e=k[g],ja&&c.getAttribute("ce208")==e.v||b.push(e);if(0<b.length)for(k=0;k<b.length;k++)a.push(b[k]);0<D.length?da(a,c,Za,null):u(a,c,Za,null)}else h(b.mds)?qc(b.mds,b.ftr):Za("ce801",b.o)}break;case C.User:h(b.mds)?qc(b.mds,b.ftr):Za("ce801",b.o);break;default:throw Error("CL58");}},qc=function(a,g){v=fb(a,g);var d=[];if(null!=v&&0<v.length){for(var b=0;b<v.length;b++)L(v[b].ID,a,v[b].Name,d);0<D.length?da(d,c,Za,
null):u(d,c,Za,null)}else Za("ce801",m.Numeric)},Za=function(a,g,d){function b(a,g){if(M){var b=c;M=!1}else b=K(c)==n.Name?c:c.nextSibling;b=tb(b,g);h(b)?ka(b):rc(a)}function e(a){var g=null,b=a?m.Date:m.Time;a=a?"":"1/1/2000 ";try{var d=c;if(K(d)!=n.Param||ha(d)!=b)d=tb(d,b);h(d)&&(g=new Date(a+d.getAttribute("ce206")));isNaN(g.getDate())&&(g=null);return g}catch(Fd){return null}}var t=fa(c);if("ce801"==a)if(a=Uc(g),h(a))R=M,g=null,0<t.ps.length&&(g=Wa(c),0>g&&(g=0),g=t.ps[g].ftr),qc(a.Name,g);else switch(parseInt(g,
10)){case m.Numeric:R=!1;Rb(tb(h(c.nextSibling)?c.nextSibling:c,m.Numeric))&&(g=Wa(c),g++,b(t,m.Numeric),Na({t:t.t,v:"",st:m.Numeric,ct:p.None,ft:n.Param,pi:g,span:c}));break;case m.String:R=!1;Rb(tb(h(c.nextSibling)?c.nextSibling:c,m.String))&&(g=Wa(c),g++,b(t,m.String),Na({t:t.t,v:"",st:m.String,ct:p.None,ft:n.Param,pi:g,span:c}));break;case m.Date:ua.close();r=3;T.show(c,sd,sc(t,T.defaultFormat()),M,e(!0));T.position();break;case m.Time:ua.close();r=4;Ca.show(c,td,sc(t,Ca.defaultFormat()),M,e(!1));
Ca.position();break;case m.Enum:a=Wa(c)+(M?0:1);0>a&&(a=0);a<=t.ps.length-1&&(v=ob(t.ps[a].e),R=M);u(v,c,ud,null);break;case m.Bool:R=M;u(Vc(),c,vd,null);break;case m.Collection:break;default:throw Error("CL62");}else"ce804"==a||"ce805"==a?(la="ce805"==a?"ce805":d,M=!0,u(na(),c,Za,null)):(g=fb(g),h(g)?(b(t,m.Numeric),Q({t:t.t,id:null,v:a,n:E(g,a).Name,st:m.Numeric,ct:p.None,ft:n.Param,it:q.Field,h:!1,fv:!1})):(a=E(x.fds,a),b(t,a.o),Q({t:t.t,id:null,v:a.v,n:a.n,st:a.o,ct:p.None,ft:n.Param,it:q.Field,
h:!1,fv:!1})),v=null,c=I(c),W()&&Va(t))},vd=function(a){Wc(a,m.Bool,Cb(a))},ud=function(a){Wc(a,m.Enum,E(v,a).Name)},Wc=function(a,g,b){var d=tb(M?c:c.nextSibling,g),e=!1;h(d)&&(ua.close(),ka(d),e=!0,M=!1);d=fa(c);e||rc(d);Q({t:d.t,id:null,v:a,n:b,st:g,ct:p.None,ft:n.Param,it:q.Input,h:!1,fv:!1});c.setAttribute("ce206",a);c=I(c);W()&&Va(d)},sd=function(a){var g=fa(c);Xc(a,g,m.Date,l.formatDate(new Date(a),sc(g,T.defaultFormat())),T)},td=function(a,g){Xc(a,fa(c),m.Time,g,Ca)},Xc=function(a,g,b,k,e){var t=
tb(M?c:c.nextSibling,b),l=!1;h(t)&&(ka(t),l=!0,M=!1);Q({t:g.t,id:null,v:a,n:k,st:b,ct:p.None,ft:n.Param,it:q.Input,h:!1,fv:!1});c=I(c);e.hide();r=0;if(!l)switch(a=Ba(c.nextSibling),K(a)){case n.Param:a=c;Q({t:g.t,id:null,v:"",n:",",st:g.t==d.Action?null:g.rt.o,ct:p.None,ft:n.Comma,it:q.None,h:!1,fv:!1});c=I(a);break;case n.End:case n.Comma:a=c,b=ca(c.previousSibling),K(b)==n.Param&&1<fa(c).ps.length&&(c=b,Q({t:g.t,id:null,v:"",n:",",st:g.t==d.Action?null:g.rt.o,ct:p.None,ft:n.Comma,it:q.None,h:!1,
fv:!1}),c=I(a))}R=!1;aa();W()&&Va(g)},rc=function(a){var g=Ba(c.nextSibling);switch(K(g)){case n.Comma:c=g;rc(a);break;case n.Param:Q({t:a.t,id:null,v:"",n:",",st:a.t==d.Action?null:a.rt.o,ct:p.None,ft:n.Comma,it:q.None,h:!1,fv:!1});c=I(c.previousSibling);break;case n.End:g=K(c)!=n.None?null:c;var b=ca(c);K(b)==n.Param&&1<fa(c).ps.length&&(c=I(b),Q({t:a.t,id:null,v:"",n:",",st:a.t==d.Action?null:a.rt.o,ct:p.None,ft:n.Comma,it:q.None,h:!1,fv:!1}),h(g)&&(c=I(g)))}},Wa=function(a){for(var c=-1;h(a)&&
K(a)!=n.Name;)K(a)==n.Param&&c++,a=a.previousSibling;return c},xb=function(a){if(h(a)&&W())if(w(c)==d.Calculation&&K(c)==n.End)u(Aa(),c,ma,null);else if(a.t==d.Function){var g=wb(c,n.Name);h(g)?"true"==g.getAttribute("ce216")?u(X(),c,U,d.RightParenthesis):u(bb(a),c,Ya,null):u(bb(a),c,Ya,null)}else a=Jb(),0<a.length&&u(a,c,Kb,null)},fa=function(a){a=wb(a,n.Name);return h(a)?E(w(a)==d.Action?x.acs:x.fds,a.getAttribute("ce208")):null},Dc=function(a,c){for(var g=0,b,d;g<a.length;g++)if(b=a[g],!h(b.Client)||
!b.Client){d=new l.StringBuilder;c?h(b.Ns)&&0<b.Ns.length&&(CodeEffects.register(b.Ns),d.append(b.Ns),d.append(".")):d.append("CodeEffects.Rule.");d.append(Yc(b.Name));h(eval(d.dump()))?d.append(".ce = ["):d.append(" = [");if(!h(b.Data)||!b.Data.length||null==b.Data[0])throw Error("Enum or menu data source is empty (CL39)");for(var e=0,m;e<b.Data.length;e++)m=b.Data[e],0<e&&d.append(","),d.append('{"ID":"'),d.append(m.ID),d.append('","Name":"'),d.append(m.Name),h(m.Filter)&&(d.append('","Filter":"'),
d.append(m.Filter)),d.append('"}');d.append("]");eval(d.dump())}},oc=function(a){switch(a){case 8:case 9:case 16:case 17:case 18:case 19:case 20:case 27:case 127:return!1;default:return!0}},u=function(a,g,b,k,m){h(a.ce)&&(a=a.ce);ua.close();var t=[];if(h(k)){a:{var n=!0;w(c)!=d.RightSource||h(c.nextSibling)||(n=!1);var p=Xa(h(c.nextSibling)?c.nextSibling:c,d.RightSource);h(p)?n&&(p=p.previousSibling):(p=Xa(c,d.Flow),h(p)?p=p.previousSibling:(p=Ma(),p=p[p.length-1]));var q=0;n=0;for(var J;h(p);){J=
w(p);if(J==d.RightSource){p=tc(p,d.LeftSource);if(h(p)&&h(p.previousSibling))p=p.previousSibling;else{n=p=0;break a}J=w(p)}if(J==d.Flow||J==d.LeftSource)break;J==d.LeftParenthesis&&q++;J==d.RightParenthesis&&n++;p=h(p.previousSibling)&&w(p.previousSibling)!=d.Flow?p.previousSibling:null}p=q}if(k==d.RightParenthesis&&p>n){if(k=new l.Menu.Item,k.Name=e.els.lbl.pe,k.Type=d.RightParenthesis,t.push(k),a[0].t==d.Clause){k=[];for(p=0;p<a.length;p++)"then"!=a[p].v&&k.push(a[p]);a=k}}else k==d.LeftParenthesis&&
(k=new l.Menu.Item,k.Name=e.els.lbl.pb,k.Type=d.LeftParenthesis,t.push(k))}for(p=0;p<a.length;p++){n=a[p];k=new l.Menu.Item;k.ID=n.v||n.ID;k.Name=n.n||n.Name;if(h(n.t)||h(n.Type))k.Type=n.t||n.Type;t.push(k)}ua.fill(g,t,b,wd,e.help?xd:null);R&&ua.alignLeft(g);R=!1;r=6;m||(D="")},da=function(a,c,b,d){a=Qc(a,D);if(0<a.length){var g=D;u(a,c,b,d,!0);ua.select(g)}else xa()},Qa=function(a,g){function b(g,b){if("ce801"==g)switch(parseInt(b,10)){case m.Numeric:Na({t:d.Value,v:"",st:m.Numeric,ct:p.None,ft:n.None,
span:c});break;default:Db(ca(a))}else if("C"==g)jc(g);else{var k=E(x.fds,g);k.t==d.Function?yb({t:k.t,m:g,v:!0}):Lc(k,g,!1)}}function k(a){if("ce801"==a){a=q();var c=null;a.t==d.Function?h(a.rt.mds)&&(c=a.rt.mds):h(a.mds)&&(c=a.mds);l(c,a.ftr)}else b(a)}function l(a,g){v=fb(a,g);null!=v&&(R=M,u(v,c,pc,null))}function q(){var a=Da(c);return h(a)?E(x.fds,a.getAttribute("ce208")):null}function r(a,g,b,k){for(var h=0;h<a.length;h++){var e=a[h];e.t!=d.Function&&e.v==b.v||L(e.v,e.o,e.n,g)}0<D.length?da(g,
c,k,null):u(g,c,k,null)}var A=q();if(h(A)){var y=A.t==d.Function?A.rt.ai:A.ai,w=Zc(A),z=null;A.t==d.Function?h(A.rt.mds)&&(z=A.rt.mds):h(A.mds)&&(z=A.mds);if(h(z)){var B=uc(w,A);if(y==C.User||0==B.length||1==B.length&&B[0].v==A.v)l(z,A.ftr);else{var G=[];0<B.length?(y==C.All&&L("ce801",w,ab(w,!0),G),r(B,G,A,k)):l(z,A.ftr)}}else y==C.User?g&&w!=m.Enum&&w!=m.Bool||Db(a):(z=[],B=uc(w,A),0<B.length?1==B.length&&A.t!=d.Function&&B[0].v==A.v?Db(a):((w==m.Numeric&&A.t==d.Function?A.rt.cal:A.cal)&&L("C",
w,e.els.lbl.c,z),y==C.All&&L("ce801",w,ab(w),z),r(B,z,A,b)):g||Db(a))}},Lc=function(a,g,b){Q({t:b?d.Calculation:d.Value,id:null,v:a.v,n:a.n,st:a.o,ct:b?p.Field:p.None,ft:n.None,it:q.Field,h:!1,fv:!1});c.setAttribute("ce206",g);W()&&(b?u(Aa(),c,ma,null):u(X(),c,U,d.RightParenthesis))},Db=function(a){function g(a){var g=null;try{var b=c;a=a?"":"1/1/2000 ";w(b)!=d.Value&&(b=Xa(b,d.Value));h(b)&&(g=new Date(a+b.getAttribute("ce206")));isNaN(g.getDate())&&(g=null)}catch(Ia){g=null}return g}xa();switch(ha(a)){case m.String:Rb(c.nextSibling)&&
Na({t:d.Value,v:"",st:m.String,ct:p.None,ft:n.None,span:null});break;case m.Date:r=3;a=Da(c);a=h(a)?E(x.fds,a.getAttribute("ce208")):null;a=h(a)?h(a.rt)?a.rt.f:a.f:T.defaultFormat();T.show(c,yd,a,M,g(!0));T.position();break;case m.Time:r=4;a=Da(c);a=h(a)?E(x.fds,a.getAttribute("ce208")):null;a=h(a)?h(a.rt)?a.rt.f:a.f:Ca.defaultFormat();Ca.show(c,zd,a,M,g(!1));Ca.position();break;case m.Enum:a=Da(a);h(a)&&(w(a)==d.Function?(a=fa(a),v=ob(a.rt.e)):(a=E(x.fds,a.getAttribute("ce208")),v=h(a.e)?ob(a.e):
a.ens),z=v,Vb=!1,R=M,u(v,c,Sc,null));break;case m.Bool:z=Vc();Vb=!0;R=M;u(z,c,Rc,null);break;default:a=Da(c),a=h(a)?E(x.fds,a.getAttribute("ce208")):null,h(a)&&(a.cal||h(a.rt)&&a.rt.cal)?(a=[],L("C",null,e.els.lbl.c,a),L("ce801",null,ab(m.Numeric),a),u(a,c,jc,null)):Rb(c.nextSibling)&&Na({t:d.Value,v:"",st:m.Numeric,ct:p.None,ft:n.None,span:null})}},Pc=function(){if(6==r||3==r||4==r)return!1;var a=Da(c);if(!h(a))return!1;a=E(x.fds,a.getAttribute("ce208"));if(a.t==d.Function?a.rt.ai:a.ai!=C.User){var g=
uc(a.o,a);return 1<g.length&&a.t!=d.Function&&g[0].v!=a.v}return!1},Ya=function(a){var g=ca(c),b=ha(g,!0);cb(Jc(a,b),null);W()?"isNull"==a||"isNotNull"==a?u(X(),c,U,d.RightParenthesis):Qa(g):ba=!1},jc=function(a){switch(a){case "C":Q({t:d.LeftBracket,id:null,v:"",n:e.els.lbl.cb,st:null,ct:p.None,ft:n.None,it:q.None,h:!1,fv:!1});a=c;Q({t:d.RightBracket,id:null,v:"",n:e.els.lbl.ce,st:null,ct:p.None,ft:n.None,it:q.None,h:!1,fv:!1});c=I(a);aa();u(Aa(),c,ma,null);break;default:Na({t:d.Value,v:"",st:m.Numeric,
ct:p.None,ft:n.None,span:c})}},ma=function(a,g){if(a==p.Number)a=parseInt(a,10),Na({t:d.Calculation,v:"",st:m.Numeric,ct:a,ft:n.None,span:Ba(c)}),aa();else if(a==p.Function){var b=E(x.fds,g);if(!h(b))throw Error("CL46");yb({t:d.Calculation,m:g,v:!1})}else{a=parseInt(a,10);b="";switch(a){case p.Field:var k=E(x.fds,g);if(!h(k))throw Error("CL48");b=k.v;k=k.n;break;case p.LeftParenthesis:k=e.els.lbl.pb;break;case p.RightParenthesis:k=e.els.lbl.pe;break;case p.Multiplication:k="&#215;";break;case p.Division:k=
"&#247;";break;case p.Addition:k="&#43;";break;case p.Subtraction:k="&#150;";break;default:throw Error("CL64");}Q({t:d.Calculation,id:null,v:b,n:k,st:null,ct:a,ft:n.None,it:q.None,h:!1,fv:!1});W()&&u(Aa(),c,ma,null)}},Nc=function(a){var g=[];L(p.Number,null,ab(m.Numeric),g);a=Ib(a);for(var b=0;b<a.length;b++)L(a[b].t==d.Function?p.Function:p.Field,a[b].v,a[b].n,g);M=R=!0;u(g,c,ma,null)},Rc=function(a){Q({t:d.Value,id:null,v:a,n:Cb(a),st:m.Bool,ct:null,ft:n.None,it:q.None,h:!1,fv:!1});c.setAttribute("ce206",
a);W()&&u(X(),c,U,d.RightParenthesis)},Sc=function(a){Q({t:d.Value,id:null,v:a,n:E(v,a).Name,st:m.Enum,ct:null,ft:n.None,it:q.None,h:!1,fv:!1});v=null;c.setAttribute("ce206",a);W()&&u(X(),c,U,d.RightParenthesis)},pa=function(a,g,b){if(h(g)&&parseInt(g,10)==d.LeftParenthesis)Q({t:d.LeftParenthesis,id:null,v:"(",n:e.els.lbl.pb,st:null,ct:p.None,ft:n.None,it:q.None,h:!1,fv:!1}),W()&&u(na(),c,pa,d.LeftParenthesis);else switch(a){case "ce802":case "ce803":la=null;g=[];for(b=0;b<x.fds.length;b++){var k=
x.fds[b];k.t==d.Field&&k.o==m.Collection&&k.ct==B.Reference&&g.push(k)}b=[];for(k=0;k<g.length;k++)L(a,g[k].v,g[k].n,b);u(b,c,Ad,null);break;case "ce804":la=b;u(na(),c,pa,null);Ha&&(la=b);break;case "ce805":la="ce805";u(na(),c,pa,null);Ha&&(la="ce805");break;default:la=null,g=E(x.fds,a),g.t==d.Function?yb({t:g.t,m:a,v:!1}):(cb(g,null),W()&&u(bb(g),c,Ya,null))}},pc=function(a){Q({t:d.Value,id:null,v:a,n:E(v,a).Name,st:m.Numeric,ct:p.None,ft:n.None,it:q.Field,h:!1,fv:!1});v=null;c.setAttribute("ce206",
a);W()&&u(X(),c,U,d.RightParenthesis)},Ad=function(a,b){var g=E(x.fds,b);Q({t:d.Exists,id:null,v:a,n:hc(a),st:null,ct:null,ft:n.None,it:q.None,h:!1,fv:!1});cb(g,null);Q({t:d.Where,id:null,v:a,n:pb(e.els.dsc,"where"),st:null,ct:null,ft:n.None,it:q.None,h:!1,fv:!1});Q({t:d.LeftSource,id:null,v:g.cv,n:e.els.lbl.ub,st:null,ct:p.None,ft:n.None,it:q.None,h:!1,fv:!1});g=c;Q({t:d.RightSource,id:null,v:x.n,n:e.els.lbl.ue,st:null,ct:p.None,ft:n.None,it:q.None,h:!1,fv:!1});c=I(g);N(c);u(na(),c,pa,d.LeftParenthesis)},
nc=function(a){M=!0;a=E(x.fds,a);var b=Xa(c,d.Field);c=I(b);cb(a,null)},nd=function(a){M=!0;Q({t:d.Exists,id:null,v:a,n:hc(a),st:null,ct:null,ft:n.None,it:q.None,h:!1,fv:!1})},sb=function(a,b,h){switch(a){case "ce804":la=h;u(rb(),c,sb,null);Ha&&(la=h);break;case "ce805":la="ce805";u(rb(),c,sb,null);Ha&&(la="ce805");break;default:a=E(x.fds,a),cb(a,null),Q({t:d.Setter,id:null,v:"to",n:pb(e.els.str,"to"),st:a.o,ct:null,ft:n.None,it:q.None,h:!1,fv:!1}),W()?Qa(ca(c)):ba=!1}},U=function(a,b){"else"==a||
"elseIf"==a?Kb(a):h(b)&&parseInt(b,10)==d.RightParenthesis?(Q({t:d.RightParenthesis,id:null,v:")",n:e.els.lbl.pe,st:null,ct:p.None,ft:n.None,it:q.None,h:!1,fv:!1}),W()&&u(X(),c,U,d.RightParenthesis)):(cb(E(e.els.cls,a),null),("then"==a||Ja(c))&&W()?u(Oa(),c,Pa,null):W()&&u(na(),c,pa,d.LeftParenthesis))},yd=function(a){var b=Da(c);b=h(b)?E(x.fds,b.getAttribute("ce208")):null;b=h(b)?h(b.rt)?b.rt.f:b.f:T.defaultFormat();var e=!0,k=Ba(c);h(k)&&w(k)==d.Value&&ha(k)==m.Date&&(c=I(k),e=!1);e?Q({t:d.Value,
id:null,v:a,n:l.formatDate(new Date(a),b),st:m.Date,ct:null,ft:n.None,it:q.None,h:!1,fv:!1}):(c.setAttribute("ce206",a),l.text(c,l.formatDate(new Date(a),b)));T.hide();R=!1;r=0;aa();W()&&u(X(),c,U,d.RightParenthesis)},zd=function(a,b){var g=!0;if(h(c.nextSibling)){var k=Ba(c.nextSibling);h(k)&&w(k)==d.Value&&ha(k)==m.Time&&(c=I(k),g=!1)}g?Q({t:d.Value,id:null,v:a,n:b,st:m.Time,ct:null,ft:n.None,it:q.None,h:!1,fv:!1}):(c.setAttribute("ce206",a),l.text(c,b));Ca.hide();R=!1;r=0;aa();W()&&u(X(),c,U,d.RightParenthesis)},
Pa=function(a){"set"==a?(Q({t:d.Setter,id:null,v:"set",n:pb(e.els.str,"set"),st:null,ct:null,ft:n.None,it:q.None,h:!1,fv:!1}),W()?u(rb(),c,sb,null):ba=!1):yb({t:E(x.acs,a).t,m:a,v:!1})},Kb=function(a){var b="and"==a;cb(E(b?e.els.cls:e.els.fls,a),null);W()&&(b?u(Oa(),c,Pa,null):"else"==a?u(Oa(),c,Pa,null):u(na(),c,pa,d.LeftParenthesis))},Q=function(a){var c=new l.Client.Element;c.n=a.n;c.v=a.v;c.t=a.t;c.o=h(a.st)?a.st:m.None;c.CalType=h(a.ct)?a.ct:p.None;c.FuncType=h(a.ft)?a.ft:n.None;c.q=a.fv;c.InpType=
h(a.it)?a.it:q.None;cb(c,a.id,a.h)},cb=function(a,b,l){var g=!(!h(c)||!h(c.nextSibling));var t=document.createElement("SPAN");t.id=h(b)?b:y.container.id+Sa;Sa++;99999999999<Sa&&(Sa=0);t.setAttribute("ce218","false");a.t==d.Field&&a.o==m.Collection?(b=E(x.fds,a.v),b.ct==B.Reference?h(b.cn)?t.innerHTML=b.cn:t.innerHTML=a.n:t.innerHTML=a.n):t.innerHTML=a.n;a.t==d.Value?(ya(t,e.valueCss),t.setAttribute("ce206",a.v)):a.t==d.Calculation?(a.CalType!=p.Function||a.FuncType!=n.Name&&a.FuncType!=n.End||ya(t,
e.valueCss),ya(t,e.calcCss),h(a.v)&&t.setAttribute("ce206",a.v),a.CalType==p.RightParenthesis?(t.onmouseover=function(a){Sb(this,$c)},t.onmouseout=function(a){Tb(this,$c)},t.style.paddingRight=t.style.paddingLeft="2px"):a.CalType==p.LeftParenthesis&&(t.onmouseover=function(a){Sb(this,ad)},t.onmouseout=function(a){Tb(this,ad)},t.style.paddingRight=t.style.paddingLeft="2px")):a.t==d.Flow?ya(t,e.flowCss):a.t==d.Field?ya(t,e.fieldCss):a.t==d.Function?a.FuncType==n.Name||a.FuncType==n.End?(t.setAttribute("ce216",
a.q?"true":"false"),a.q||a.CalType==p.Function?ya(t,e.valueCss):ya(t,e.fieldCss)):(ya(t,e.paramCss),a.InpType==q.Input&&h(a.v)&&t.setAttribute("ce206",a.v)):a.t==d.Action?a.FuncType==n.Name||a.FuncType==n.End?ya(t,e.actionCss):(ya(t,e.paramCss),a.InpType==q.Input&&h(a.v)&&t.setAttribute("ce206",a.v)):a.t==d.Operator?ya(t,e.operCss):a.t==d.LeftBracket||a.t==d.RightBracket?ya(t,e.skobkiCss):a.t==d.LeftSource||a.t==d.RightSource?ya(t,e.braceCss):a.t==d.Clause||a.t==d.Setter||a.t==d.Where||a.t==d.Exists?
ya(t,e.clauseCss):a.t==d.Tab?ya(t,e.tabCss):a.t==d.NewLine&&ya(t,e.lineCss);a.t==d.Tab?t.style.paddingRight=t.style.paddingLeft="8px":a.t!=d.Function&&a.t!=d.Action&&a.t!=d.Calculation||a.FuncType!=n.End?(a.t==d.RightParenthesis?(t.onmouseover=function(a){Sb(this,bd)},t.onmouseout=function(a){Tb(this,bd)},h(e.skobkiCss)&&0<e.skobkiCss.length&&(t.className=Z(e.skobkiCss))):a.t==d.LeftParenthesis&&(t.onmouseover=function(a){Sb(this,cd)},t.onmouseout=function(a){Tb(this,cd)},h(e.skobkiCss)&&0<e.skobkiCss.length&&
(t.className=Z(e.skobkiCss))),t.style.paddingRight=t.style.paddingLeft="2px"):(b=E(a.t==d.Action?x.acs:x.fds,a.v),h(b)&&h(b.ps)&&0!=b.ps.length||(t.style.paddingRight=t.style.paddingLeft="0",t.style.width="2px"));t.style.paddingBottom="2px";t.style.display="inline-block";t.style.whiteSpace="nowrap";t.setAttribute("ce202",a.t);a.t==d.Field&&a.o==m.Bool&&(a.ir?t.setAttribute("ce213","true"):(b=E(x.fds,a.v),h(b)&&h(b.ir)&&b.ir&&t.setAttribute("ce213","true")));t.setAttribute("ce203",h(a.CalType)?a.CalType:
p.None);t.setAttribute("ce204",h(a.FuncType)?a.FuncType:n.None);t.setAttribute("ce205",h(a.InpType)?a.InpType:q.None);t.setAttribute("ce208",a.v);h(a.o)&&a.o!=m.None?t.setAttribute("ce209",a.o):t.setAttribute("ce209",m.None);M&&$a();M=!1;if(g){if(g=c.nextSibling,y.container.insertBefore(t,c.nextSibling),a.t!=d.Tab){if(h(g)&&w(g)==d.Tab)for(;h(g)&&w(g)==d.Tab;)b=g.nextSibling,y.container.removeChild(g),g=b;if(h(g)){if(a.t==d.RightBracket&&w(g)==d.LeftBracket){for(;w(g)!=d.RightBracket;)b=g.nextSibling,
y.container.removeChild(g),g=b;y.container.removeChild(g)}a.t!=d.Calculation||a.CalType!=p.Field&&a.CalType!=p.Number?(a.t==d.Value||a.t==d.Operator&&"isNull"!=a.v&&"isNotNull"!=a.v||a.t==d.Clause&&"then"==a.v||a.t==d.Flow&&"else"==a.v)&&a.t==w(g)&&a.o==ha(g)&&y.container.removeChild(g):a.t==w(g)&&Bd(a.CalType,V(g))&&y.container.removeChild(g)}}}else y.container.appendChild(t);a.t!=d.Function&&a.t!=d.Action&&a.t!=d.Calculation||a.FuncType!=n.End||!sa(t)?c=l?t:I(t):Ua(t,l);e.titles&&Cd(a);ja=!1;aa()},
Na=function(a){xa();var b=ca(h(a.span)?a.span:c),t=document.createElement("INPUT");t.type="text";t.id=y.container.id+Sa;Sa++;99999999999<Sa&&(Sa=0);t.className="ceValue";t.style.marginRight=t.style.marginLeft="2px";t.style.width="2px";var k=Da(b);b=null;h(k)&&(b=E(x.fds,k.getAttribute("ce208")),h(b)||(b=E(x.acs,k.getAttribute("ce208"))));if(h(b)){k=-9007199254740992;var u=null,v=null;b.t==d.Function||b.t==d.Action?a.ft==n.Param?h(a.pi)&&h(b.ps[a.pi])&&(k=h(b.ps[a.pi].min)?b.ps[a.pi].min:k,h(b.ps[a.pi].max)&&
(u=b.ps[a.pi].max),v=h(b.ps[a.pi].dec)?b.ps[a.pi].dec:!0):(k=h(b.rt.min)?b.rt.min:k,h(b.rt.max)&&(u=b.rt.max),v=h(b.rt.dec)?b.rt.dec:!0):(k=h(b.min)?b.min:k,h(b.max)&&(u=b.max),v=h(b.dec)?b.dec:!0);a.st==m.Numeric?(t.maxLength=28,t.setAttribute("ce212",h(u)?u.toString():(-1*k).toString()),t.setAttribute("ce211",k.toString()),t.setAttribute("ce214",v?"1":"0"),t.setAttribute("ce215",0>k?"1":"0")):(t.maxLength=h(u)?u:256,t.setAttribute("ce212",t.maxLength.toString()))}else t.maxLength=256,t.setAttribute("ce212",
t.maxLength.toString());h(a.span)?w(a.span)==d.Value||w(a.span)==d.Calculation&&V(a.span)==p.Number||(w(a.span)==d.Function||w(a.span)==d.Action)&&za(a.span)==q.Input?(Ga=a.span.id,a.span.style.display="none",y.container.insertBefore(t,a.span)):(Ga=null,h(a.span.nextSibling)?y.container.insertBefore(t,a.span.nextSibling):y.container.appendChild(t)):h(c)&&h(c.nextSibling)?y.container.insertBefore(t,c.nextSibling):(Ga=null,y.container.appendChild(t));t.setAttribute("ce202",a.t);t.setAttribute("ce209",
h(a.st)?a.st:m.None);t.setAttribute("ce206",a.v);t.setAttribute("ce203",h(a.ct)?a.ct:p.None);t.setAttribute("ce204",h(a.ft)?a.ft:n.None);t.setAttribute("ce205",q.Input);t.setAttribute("ce208",a.v);dd(t);r=0;t.value=h(a.v)?l.decode(a.v):"";0<t.value.length&&kb(t);if(0==t.value.length)try{t.focus()}catch(F){}else try{t.select()}catch(F){}t.onkeydown=function(a){a=new l.Event(a);var c=ha(this);if(c==m.Numeric&&32==a.keyCode)return qb(e.els.er.e112),a.preventDefault(),!1;if(8==a.keyCode||32==a.keyCode||
127==a.keyCode||37==a.keyCode||39==a.keyCode)return!0;if(c==m.Numeric){var b=a.keyCode;c="1"==this.getAttribute("ce214");var d="1"==this.getAttribute("ce215");if(!c&&(188==b||190==b||110==b))return qb(e.els.er.e110),a.preventDefault(),!1;if(!d&&(109==b||189==b))return qb(e.els.er.e111),a.preventDefault(),!1;switch(b){case 188:case 190:case 110:c=188==b?",":".";if(0==this.value.length)return this.value="0"+c,kb(this,a.keyCode),a.preventDefault(),!1;-1<this.value.indexOf(",")||-1<this.value.indexOf(".")?
qb(e.els.er.e113):(this.value+=c,this.value=="-"+c&&(this.value="-0"+c),1<this.value.length&&"0"==this.value.substr(0,1)&&this.value.substr(1,1)!=c&&(this.value=this.value.substr(1)),2<this.value.length&&"-0"==this.value.substr(0,2)&&this.value.substr(2,1)!=c&&(this.value="-"+this.value.substr(2)));a.preventDefault();return!1;case 109:case 189:return 0==this.value.length?(this.value="-",kb(this,109)):0>this.value.indexOf("-")&&(this.value="-"+this.value,kb(this,109)),a.preventDefault(),!1;default:96<=
b&&105>=b&&(b-=48),b=this.value.replace(",",".")+String.fromCharCode(b),1<b.length&&"0"==b.substr(0,1)&&"."!=b.substr(1,1)&&(this.value=this.value.substr(1,1),b=b.substr(1,1)),2<b.length&&"-0"==b.substr(0,2)&&"."!=b.substr(2,1)&&(this.value="-"+this.value.substr(2),b="-"+b.substr(2))}if(c&&!l.isNumeric(b)||!c&&!l.isInteger(b))return qb(e.els.er.e112),kb(this),a.preventDefault(),!1}kb(this,a.keyCode);va()};t.onkeyup=function(a){a=new l.Event(a);if(ha(this)==m.Numeric){var c=parseInt(this.getAttribute("ce212"),
10),b=parseInt(this.getAttribute("ce211"),10),d=parseInt(this.value,10),g=null;d<b?(g=e.els.er.e109,this.value=b.toString()):d>c&&(g=e.els.er.e108,this.value=c.toString());h(g)&&qb(g)}8!=a.keyCode&&32!=a.keyCode&&127!=a.keyCode||kb(this);this.setAttribute("ce206",this.value)};t.onpaste=function(a){if(ha(this)==m.Numeric)return!1;var c=this;setTimeout(function(){kb(c)},60)}},kb=function(a,c){if(!(h(c)&&a.value.length>=a.maxLength)){var b=document.createElement("SPAN");b.id="ceTxt"+y.container.id;b.className=
"ceValue";b.style.whiteSpace="nowrap";y.container.appendChild(b);b.innerHTML=$rule.encode(a.value+(h(c)?String.fromCharCode(c):""));var d=Ta(b).width;y.container.removeChild(b);a.style.width=d+2+"px"}},Cd=function(a){function b(a){a=E(x.fds,a);h(a)&&h(a.d)&&(c.title=nb(a.d))}switch(a.t){case d.Function:case d.Action:switch(a.FuncType){case n.Name:a=E(a.t==d.Function?x.fds:x.acs,a.v);h(a)&&h(a.d)&&(c.title=nb(a.d));break;case n.Param:if(a=fa(c),h(a)&&0<a.ps.length){var e=Wa(c);0<=e&&(a=a.ps[e],h(a)&&
h(a.d)&&(c.title=nb(a.d)))}}break;case d.Field:b(a.v);break;case d.Value:a.InpType==q.Field&&b(a.v);break;case d.Calculation:a.CalType==p.Field&&b(a.v)}},$a=function(){w(c)==d.HtmlTag&&(c=I(h(c.nextSibling)?c.nextSibling:c.previousSibling),N(c));switch(w(c)){case d.Calculation:case d.Function:case d.Action:switch(K(c)){case n.Name:for(;K(c)!=n.End;){var a=c.nextSibling;y.container.removeChild(c);c=a}ka(c);break;case n.End:for(;K(c)!=n.Name;)ka(c);ka(c);break;case n.Comma:for(ka(c);K(c)!=n.Name&&K(c)!=
n.Comma;)ka(c);break;case n.Param:a=Ba(c.nextSibling);if(K(a)==n.Comma)c=a,$a();else for(ka(c);K(c)!=n.Name&&K(c)!=n.Param;)ka(c);break;default:ka(c)}break;case d.Field:a=E(x.fds,c.getAttribute("ce208"));h(a)&&a.o==m.Collection&&a.ct==B.Reference?ed(c):ka(c);break;case d.LeftBracket:if(!h(c.nextSibling))throw Error("CL82");for(;w(c)!=d.RightBracket;)a=c.nextSibling,y.container.removeChild(c),c=a;ka(c);break;case d.RightBracket:if(!h(c.previousSibling))throw Error("CL84");for(;w(c)!=d.LeftBracket;)ka(c);
ka(c);break;case d.RightSource:case d.LeftSource:case d.Where:case d.Exists:ed(c);break;default:ka(c)}aa()},ed=function(a){if(!M){a=w(c)==d.RightSource?c:fd(c,d.RightSource);if(!h(a)){ka(c);return}for(var b=tc(a,d.Exists).id,e;a.id!=b;)e=a.previousSibling,y.container.removeChild(a),a=e;c=I(a)}ka(c)},ka=function(a){if(h(a.previousSibling)){var b=a.previousSibling;y.container.removeChild(a);c=I(b);N(c)}},Sb=function(a,b){if(!Ub(a)){var d=b(a);if(h(d)){if(1==r||a.id!=c.id)a.className=a.className+" "+
e.highlightBg;Ub(d)||1!=r&&d.id==c.id||(d.className=d.className+" "+e.highlightBg)}}},Tb=function(a,b){if(!Ub(a)){var d=b(a);if(h(d)){if(1==r||a.id!=c.id)a.className=$rule.trim(a.className.replace(e.highlightBg,""));Ub(d)||1!=r&&d.id==c.id||(d.className=$rule.trim(d.className.replace(e.highlightBg,"")))}}},Ub=function(a){if(!h(O)||0==O.length)return!1;for(var b=0;b<O.length;b++)if(O[b]==a.id)return!0;return!1},bd=function(a){var b=1;a=a.previousSibling;for(var c;h(a);){c=w(a);if(c==d.RightSource)if(a=
tc(a,d.LeftSource),h(a)&&h(a.previousSibling))a=a.previousSibling,c=w(a);else{a=null;break}c==d.RightParenthesis?b++:c==d.LeftParenthesis&&b--;if(0==b)break;else if(c==d.LeftSource||c==d.Flow){a=null;break}else a=a.previousSibling}return h(a)?a:null},cd=function(a){var b=1;a=a.nextSibling;for(var c;h(a);){c=w(a);if(c==d.LeftSource)if(a=fd(a,d.RightSource),h(a)&&h(a.nextSibling))a=a.nextSibling,c=w(a);else{a=null;break}c==d.RightParenthesis?b--:c==d.LeftParenthesis&&b++;if(0==b)break;else if(c==d.RightSource||
c==d.Flow){a=null;break}else a=a.nextSibling}return h(a)?a:null},$c=function(a){var b=1;for(a=a.previousSibling;h(a)&&(V(a)==p.LeftParenthesis?b--:V(a)==p.RightParenthesis&&b++,0!=b);)a=a.previousSibling;return h(a)&&w(a)!=d.LeftBracket?a:null},ad=function(a){var b=1;for(a=a.nextSibling;w(a)!=d.RightBracket&&(V(a)==p.RightParenthesis?b--:V(a)==p.LeftParenthesis&&b++,0!=b);)a=a.nextSibling;return h(a)&&w(a)!=d.RightBracket?a:null},tc=function(a,b){for(var c=0,g=0,e;h(a);){e=w(a);e==d.LeftSource&&c++;
if(c==g&&e==b)return a;e==d.RightSource&&g++;a=h(a.previousSibling)&&w(a.previousSibling)!=d.Flow?a.previousSibling:null}return null},fd=function(a,b){for(var c=0,g=0,e;h(a);){e=w(a);e==d.RightSource&&g++;if(c==g&&e==b)return a;e==d.LeftSource&&c++;a=h(a.nextSibling)&&w(a.nextSibling)!=d.Flow?a.nextSibling:null}return null},eb=function(a,b){if(!h(c.nextSibling)||w(c.nextSibling)!=d.HtmlTag||!h(c.nextSibling.nextSibling.nextSibling)||w(c.nextSibling.nextSibling.nextSibling)!=d.HtmlTag){var g=document.createElement("BR");
g.setAttribute("ce202",d.HtmlTag);h(c)&&h(c.nextSibling)||a?y.container.insertBefore(g,a?c:c.nextSibling):y.container.appendChild(g);c=b?g:I(g);Q({t:d.NewLine,id:null,v:"",n:e.tochki?"&#149;&nbsp;":"&nbsp;&nbsp;",st:null,ct:null,ft:null,fv:!1,it:null,h:b})}},Tc=function(){Hc();e.help&&hb(e.els.ms.i101);ra=0;D="";Ha=!1;r=2;N(null)},Bc=function(){if(h(y)&&h(y.container)&&h(e)){6!=r&&8!=r||xa();Tc();if(e.tools){oa.setValue(e.els.lbl.n);oa.setClass(e.nameDefCss);Ra.setValue(e.els.lbl.d);Ra.setClass(e.descDefCss);
var a=document.getElementById("ceC"+y.container.id);a&&a.parentNode.removeChild(a)}ia=null;r=1}},Rb=function(a){if(h(a)&&(a=Ba(a),h(a))){var b=ha(a);if(gb(w(a),b,V(a),za(a))&&za(a)!=q.Field)return b!=m.String&&b!=m.Numeric&&dd(a),c=I(c),M=R=!1,aa(),!1}return!0},fc=function(){if(h(O)&&0<O.length){for(var a,b=0;b<O.length;b++)a=document.getElementById(O[b]),h(a)&&(a.className=$rule.trim(a.className.replace(e.highlightBg,"")),a.title="");O=[]}e.help&&(Y.className=$rule.trim(Y.className.replace(e.invalidColor,
"")))},Lb=function(){ta=null;for(var a=l.getChildrenByAttribute(y.container,"ce218","true"),b,c=0;c<a.length;c++)b=a[c],b.className=l.trim(b.className.replace(e.selectedBg,"")),b.setAttribute("ce218","false")},Oc=function(a,b){Ea=[];sibling=null;var g=l.getChildrenByAttribute(y.container,"ce218","true");if(0<g.length){for(var k=!1,m=!1,p=0,q,r;p<g.length;p++){q=g[p];r=w(q);f=K(q);switch(r){case d.HtmlTag:k=!0;break;case d.NewLine:case d.Tab:if(!k)continue;break;default:k=!1}switch(r){case d.Function:case d.Action:if(f==
n.Name)m=!0;else if(!m)continue;break;case d.Calculation:if(f==n.Name)m=!0;else if(f==n.None||m)m=!1;else continue;break;default:m=!1}a&&h(q.previousSibling)&&(sibling=q.previousSibling,r=w(sibling),r==d.HtmlTag||r==d.NewLine)&&(sibling=sibling.previousSibling);r=a?y.container.removeChild(q):q.cloneNode(!0);r.className=l.trim(q.className.replace(e.selectedBg,""));r.setAttribute("ce218","false");Ea.push(r)}a&&h(sibling)&&(c=I(sibling));va(b,g.length)}},Ec=function(a){var b="ceT"+y.container.id;ea=
document.getElementById(b);h(ea)&&ea.parentNode.removeChild(ea);ea=document.createElement("DIV");ea.id=b;ea.className=Z(e.toolCss);b=document.createElement("TABLE");b.cellPadding=b.cellSpacing=b.border=0;b.style.width="100%";var c=b.insertRow(-1),k=c.insertCell(-1);k.style.paddingRight="6px";a?Fc(k):(Fa=document.createElement("SPAN"),Fa.id="ceRl"+y.container.id,Fa.className=Z(e.rulesCss),Fa.innerHTML=e.els.lbl.r+"&nbsp;&#9662;",k.appendChild(Fa),Fa.onclick=function(a){N(null);(new l.Event(a)).stopPropagation();
vb();R=!0;0<D.length?da(P,Fa,Pb,null):u(P,Fa,Pb,null);r=8},k=c.insertCell(-1),k.style.textAlign="right",spnShared=document.createElement("SPAN"),spnShared.className=e.lblCss,spnShared.style.display="none",k.appendChild(spnShared),oa=new l.TextBox.Control,oa.init(new l.TextBox.Settings(k,"ceTl"+y.container.id,Z(e.nameCss),Z(e.nameDefCss),50,e.els.lbl.n,e.els.er.e104,Z(e.invalidColor))),Ra=new l.TextBox.Control,Ra.init(new l.TextBox.Settings(k,"ceTd"+y.container.id,Z(e.descCss),Z(e.descDefCss),80,e.els.lbl.d,
e.els.er.e104,Z(e.invalidColor))),a=document.createElement("SPAN"),a.id="ceA"+y.container.id,a.className=Z(e.saveButCss),a.innerHTML=e.els.lbl.a,k.appendChild(a),a.onclick=function(a){6!=r&&8!=r||xa();a=Ma();0!=a.length&&(1!=a.length||h(w(a[0]))&&w(a[0])!=d.Flow)?vc("ceSave"):alert(e.els.er.e106)});ea.appendChild(b);y.container.appendChild(ea)},Fc=function(a,b){if(h(e.els.ms.i101)){var c="ceH"+y.container.id;Y=document.getElementById(c);h(Y)&&Y.parentNode.removeChild(Y);Y=document.createElement("DIV");
Y.id=c;b&&(Y.className=Z(e.helpCss));a.appendChild(Y);Y.innerHTML=e.els.ms.i101}else Gc()},Gc=function(){var a=document.getElementById("ceH"+y.container.id);h(a)&&a.parentNode.removeChild(a);Y=null;e.help=!1},vc=function(a){mb=a;N(null);if(y.clientOnly)switch(mb){case "ceDelete":if(!h(ia))throw Error("CL31");if(!h(bc)){alert("The Delete action is not defined");break}db=!0;bc(ia);break;case "ceSave":if(!h(ac)){alert("The Save action is not defined");break}db=!1;ac(lb.serialize(Gb()));break;default:h(cc)?
(db=!0,cc(a)):alert("The Load action is not defined")}else if(y.asp){db="ceSave"!=mb;try{eval(e.pb+"('"+y.id+"','')")}catch(t){alert("Unexpected order of elements (CL81)")}}else switch(mb){case "ceDelete":if(!h(ia))throw Error("CL32");e.pb&&e.pb.d?window.location=e.pb.d.replace("_ce_",ia):alert("The Delete action is not defined");break;case "ceSave":if(!h(y.fieldId))throw Error("CL33");if(e.pb&&e.pb.s)if(h(y.form))gc(),y.form.action?y.form.action=e.pb.s:y.form.setAttribute("action",e.pb.s),y.form.submit();
else{a=document.createElement("FORM");document.body.appendChild(a);a.setAttribute("ce","form"+y.container.id);a.action?a.action=e.pb.s:a.setAttribute("action",e.pb.s);a.method?a.method="post":a.setAttribute("method","post");var b=document.createElement("INPUT");b.type="hidden";b.id=y.fieldId;b.name=y.id;db=!1;b.value=lb.serialize(Gb());a.appendChild(b);a.submit()}else alert("The Save action is not defined");break;default:e.pb&&e.pb.l?window.location=e.pb.l.replace("_ce_",mb):alert("The Load action is not defined")}},
xd=function(a){if(e.help){var b=E(x.fds,a),c=null;h(b)?b.d&&(c=b.d):(b=E(x.acs,a),h(b)&&b.d?c=b.d:(b=E(e.els.rls,a),h(b)&&b.d&&(c=b.d)));h(c)&&0<c.length?hb(c):va()}},Pb=function(a){"ceEval"==a||"ceExec"==a?(e.isEval="ceEval"==a,Bc()):(ua.close(),r=1,vc(a))},zc=function(){var a="ceC"+y.container.id;if(!h(document.getElementById(a))){var b=document.createElement("SPAN");b.id=a;b.className=Z(e.deleteCss);b.innerHTML=e.els.lbl.u;l.getChildrenByTagName(ea,"TABLE",!0)[0].rows[0].cells[1].appendChild(b);
b.onclick=function(a){confirm(e.els.er.e105)&&vc("ceDelete")}}},ob=function(a){a=eval(Yc(a));return h(a.ce)?a.ce:a},E=function(a,b){if(h(a)){h(a.ce)&&(a=a.ce);for(var c,d=0;d<a.length;d++)if(c=a[d],h(c.v)&&c.v==b||h(c.ID)&&c.ID==b)return c}return null},na=function(){var a=[];if(x.references){L("ce802",d.Field,e.els.lbl.h,a);L("ce803",d.Field,e.els.lbl.l,a);for(var b=0;b<x.fds.length;b++){var c=x.fds[b];if(c.t==d.Field&&c.o==m.Collection){if(c.ct==B.Generic)throw Error("CL83");c.ct!=B.Reference&&a.push(c)}else a.push(c)}}else a=
x.fds;var k=h(ia),l=[],n=h(la);for(b=0;b<a.length;b++)if(c=a[b],!h(c.gtb)||c.gtb)if(!c.ir||!k||c.v!=ia){if(n)if(h(c.grp))if("ce805"==la)continue;else{if(c.grp!=la)continue}else if("ce805"!=la)continue;l.push(c)}return gd(l,x.references)},gd=function(a,b){function c(a,b){return a.Name.localeCompare(b.Name)}if(h(la))return la=null,a;for(var d=[],g=!1,l=0,m;l<a.length;l++)m=a[l],h(m.grp)?Dd(d,m.grp)||d.push({ID:"ce804",Name:m.grp}):g=!0;if(0<d.length){m=[];b&&(m.push(a[0]),m.push(a[1]));d.sort(c);for(l=
0;l<d.length;l++)m.push(d[l]);g&&m.push({ID:"ce805",Name:e.els.lbl.eg});return m}return a},Dd=function(a,b){for(var c=0;c<a.length;c++)if(a[c].Name==b)return!0;return!1},rb=function(){for(var a=[],b=h(la),c,k=0;k<x.fds.length;k++)if(c=x.fds[k],!(c.ir||c.t==d.Function||c.o==m.Collection||h(c.st)&&!c.st)){if(b)if(h(c.grp))if("ce805"==la)continue;else{if(c.grp!=la)continue}else if("ce805"!=la)continue;a.push(c)}return gd(a,!1)},mc=function(a){for(var b=[],c=E(x.fds,a),d=0;d<x.fds.length;d++)a=x.fds[d],
a.v!=c.v&&a.o==m.Collection&&a.ct==B.Reference&&a.cc==c.cc&&a.cl==c.cl&&a.cv==c.cv&&b.push(a);return b},Oa=function(){for(var a=[],b=!1,c=0,k;c<x.fds.length;c++)if(k=x.fds[c],k.o!=m.Collection&&k.t!=d.Function&&!k.ir&&(!h(k.st)||k.st)){b=!0;break}b&&L("set",null,e.els.lbl.w,a);for(c=0;c<x.acs.length;c++)a.push(x.acs[c]);return a},X=function(){if(Ja(c))return Jb();var a=[];var b=0;for(var l=c,k;h(l);){k=w(l);if(k==d.Flow)break;k==d.LeftSource?b--:k==d.RightSource&&b++;l=h(l.previousSibling)&&w(l.previousSibling)!=
d.Flow?l.previousSibling:null}b=0==b;for(k=0;k<e.els.cls.length;k++)l=e.els.cls[k],(!e.isEval&&b||"then"!=l.v)&&a.push(l);return a},md=function(a){for(var b=[],c,d=0;d<e.els.cls.length;d++)c=e.els.cls[d],"then"!=c.v&&c.v!=a&&b.push(c);return b},Jc=function(a,b){for(var c=0;c<e.els.ops.length;c++)if(e.els.ops[c].v==a&&e.els.ops[c].o==b)return e.els.ops[c];return null},bb=function(a,b){var c=[];if(a.t==d.Function){var g=a.rt.o;var l=a.rt.l;var n=h(a.rt.mds)}else a.ir?(l=n=!1,g=m.Bool):(l=a.l,g=a.o,
n=h(a.mds));for(var p=0;p<e.els.ops.length;p++){var q=e.els.ops[p];if(q.o==g&&(!h(b)||q.v!=b)&&(l||"isNull"!=q.v&&"isNotNull"!=q.v)){if(g==m.Numeric&&n)if(l){if("isNull"!=q.v&&"isNotNull"!=q.v&&"equal"!=q.v&&"notEqual"!=q.v)continue}else if("equal"!=q.v&&"notEqual"!=q.v)continue;c.push(q)}}return c},Vc=function(){var a=[];L("true",null,e.els.lbl.t,a);L("false",null,e.els.lbl.f,a);return a},uc=function(a,b){var g=[];Ja(c);for(var k,e,l,n,p=b.t==d.Function?b.rt.e:b.e,q=b.t==d.Function?b.rt.mds:b.mds,
r=0;r<x.fds.length;r++)if(k=x.fds[r],k.o!=m.Collection&&(e=Zc(k),n=k.t==d.Function?k.rt.e:k.e,l=k.t==d.Function?k.rt.mds:k.mds,e!=m.Enum||h(p)&&p==n))e!=a||k.ir||(h(l)?h(q)&&l==q&&g.push(k):h(q)||h(b.ftr)&&"any"!=b.ftr&&"any"!=k.ftr&&b.ftr!=k.ftr||g.push(k));return g},Ib=function(a){var b=null;if(h(a))e=E(x.fds,a),h(e)&&h(e.ftr)&&(b=e.ftr);else if(e=Da(c),h(e)){var e=E(x.fds,e.getAttribute("ce208"));h(e)&&h(e.ftr)&&(b=e.ftr)}e=[];for(var k,l=0,n;l<x.fds.length;l++)k=x.fds[l],n=h(k.ftr)?k.ftr:null,
(k.t!=d.Field||k.ir||h(k.mds)||k.o!=m.Numeric||!k.i||h(a)&&k.v==a||null!=b&&"any"!=b&&b!=n&&"any"!=n)&&(k.t!=d.Function||k.rt.o!=m.Numeric||!k.i||h(a)&&k.v==a||null!=b&&"any"!=b&&b!=n&&"any"!=n)||e.push(k);return e},fb=function(a,b){var c=Uc(a),d=null;null!=c&&(d=c.Client?eval(c.Data[0]+"()"):eval("CodeEffects.Rule."+a));if(h(b)){c=[];for(var g=0,e;g<d.length;g++)e=d[g],h(e.Filter)&&"any"!=b&&"any"!=e.Filter&&e.Filter!=b||c.push(e);return c}return d},Uc=function(a){if(!h(e.els.mds))return null;for(var b=
0;b<e.els.mds.length;b++)if(e.els.mds[b].Name==a)return e.els.mds[b];return null},Zc=function(a){if(a.t==d.Function)return a.rt.o;var b=a.o;if(b==m.Collection){if(a.ct!=B.Value)throw Error("CL71");return a.co}return b},dd=function(a){if(h(La)){var b=document.getElementById(La);h(b)&&(b.className=$rule.trim(b.className.replace(e.currentBg,"")))}h(c)&&(c.className=$rule.trim(c.className.replace(e.currentBg,"")));a.setAttribute("ce207","true");c=a},wa=function(){if(h(c)&&(c.removeAttribute("ce207"),
"INPUT"==c.tagName)){var a=ha(c),b="";if(a==m.Numeric){var d=c.getAttribute("ce206"),k=parseInt(c.getAttribute("ce211"),10);try{if(h(d)){var l=parseFloat(d.replace(",","."));b=h(l)&&"-0."!=d&&"0."!=d?l.toString():k.toString()}else b=k.toString()}catch(Ia){b=k.toString()}}else b=$rule.encode(c.value);d=c;h(Ga)?(a=document.getElementById(Ga),h(a)&&(c=I(a),c.innerHTML=0==b.length?e.els.lbl.em:b,c.setAttribute("ce206",b),c.setAttribute("ce205",q.Input),c.style.display="")):Q({t:w(d),id:null,v:b,n:0==
b.length?e.els.lbl.em:b,st:a,ct:V(d),ft:K(d),it:q.Input,h:!1,fv:!1});Ga=null;y.container.removeChild(d)}},Jb=function(){var a=[];a.push(E(e.els.cls,"and"));for(var b=Ma(),h=!1,k=!1,l=0;l<b.length;l++){if(w(b[l])==d.Flow&&"else"==b[l].getAttribute("ce208")){h=!0;break}b[l].id==c.id&&(k=!0)}if(!k&&h)return a;for(b=0;b<e.els.fls.length;b++)"if"==e.els.fls[b].v||h&&"else"==e.els.fls[b].v||a.push(e.els.fls[b]);return a},pb=function(a,b){for(var c,d=0;d<a.length;d++)if(c=a[d],c.v==b)return c.n;return null},
hc=function(a){return pb(e.els.dsc,"ce803"==a?"doesNotExist":"exists")},Aa=function(){function a(a){var b=0,g=0,k;a:{for(k=c;h(k);){if(w(k)==d.RightBracket)break a;k=k.nextSibling}k=null}for(k=k.previousSibling;h(k)&&w(k)!=d.LeftBracket;)V(k)==p.LeftParenthesis&&b++,V(k)==p.RightParenthesis&&g++,k=k.previousSibling;b>g&&L(p.RightParenthesis,null,e.els.lbl.pe,a);L(p.Addition,null,"&#43;",a);L(p.Subtraction,null,"&#150;",a);L(p.Multiplication,null,"&#215;",a);L(p.Division,null,"&#247;",a)}var b=[];
switch(w(ca(c))){case d.LeftBracket:L(p.LeftParenthesis,null,e.els.lbl.pb,b);L(p.Number,null,ab(m.Numeric),b);for(var l=Ib(),k=0;k<l.length;k++)L(l[k].t==d.Function?p.Function:p.Field,l[k].v,l[k].n,b);break;case d.Value:case d.Calculation:l=V(c);l==p.None&&(l=V(ca(c)));switch(l){case p.Number:case p.Field:case p.RightParenthesis:a(b);break;case p.Function:K(c)==n.End&&a(b);break;case p.LeftParenthesis:case p.Addition:case p.Subtraction:case p.Multiplication:case p.Division:for(L(p.LeftParenthesis,
null,e.els.lbl.pb,b),L(p.Number,null,ab(m.Numeric),b),l=Ib(),k=0;k<l.length;k++)L(l[k].t==d.Function?p.Function:p.Field,l[k].v,l[k].n,b)}break;default:throw Error("CL80");}return b},sc=function(a,b){if(!h(a)||0==a.ps.length)return b;var d=Wa(c);for(0>d&&(d=0);d<a.ps.length;){if(h(a.ps[d].f))return a.ps[d].f;d++}return b},L=function(a,b,c,d){var g=new l.Menu.Item;g.ID=a;h(b)&&(g.Type=b+"");g.Name=c;d.push(g)},Bd=function(a,b){if(a==p.None||b==p.None)throw Error("CL90");switch(a){case p.Field:return b==
p.Number||b==p.Field;case p.Number:return b==p.Field||b==p.Number;case p.LeftParenthesis:return b==p.LeftParenthesis;case p.RightParenthesis:return b==p.RightParenthesis;default:return b==p.Multiplication||b==p.Division||b==p.Addition||b==p.Subtraction}},Qc=function(a,b){var c=[];if(!h(a)||0==a.length)return c;b=b.toLowerCase();for(var d,g=0;g<a.length;g++)d=a[g].n||a[g].Name,d.length>=b.length&&d.substr(0,b.length).toLowerCase()==b&&c.push(a[g]);return c},Ed=function(){if(!h(c))return"i101";if(8==
r)return"i126";var a=ca(c);switch(w(a)){case d.Flow:return"else"==a.getAttribute("ce208")?"i110":"i103";case d.LeftSource:case d.LeftParenthesis:return"i103";case d.RightSource:case d.RightParenthesis:return"i111";case d.Field:if(ja)return"i127";a=E(x.fds,a.getAttribute("ce208"));return h(a)?a.o==m.Collection&&a.ct==B.Reference?"i124":"i104":"i124";case d.Exists:return ja?"i136":"i135";case d.Where:return"i124";case d.LeftBracket:return"i106";case d.RightBracket:return"i121";case d.Calculation:return"i108";
case d.Action:switch(K(a)){case n.End:return sa(a)&&ja?"i128":"else"==lc(a,d.Flow).getAttribute("ce208")?"i124":"i125";case n.Name:return ja?"i128":"i123";default:return"i123"}case d.Function:switch(K(a)){case n.End:return sa(a)&&ja?"i127":"i104";case n.Name:return ja?"i127":"i123";default:return"i123"}case d.Operator:if(ja)return"i129";var b=ha(a);return b==m.Numeric?(a=Da(a),a=h(a)?E(x.fds,a.getAttribute("ce208")):null,h(a)&&a.cal?"i122":"i113"):b==m.String?"i113":b==m.Date?"i114":b==m.Time?"i117":
"i119";case d.Value:return b=ha(a),b==m.String||b==m.Numeric?h(a.getAttribute("ce207"))?"i105":"i107":b==m.Date?3==r?"i109":ja?"i132":"i115":b==m.Time?4==r?"i116":ja?"i133":"i118":ja?"i134":"i120";case d.Clause:return"then"==a.getAttribute("ce208")?"i110":ja?"i129":"i103";default:return"i122"}},ab=function(a,b){switch(a){case m.String:return e.els.lbl.s;case m.Date:return e.els.lbl.v;case m.Time:return e.els.lbl.j;case m.Numeric:return b?e.els.lbl.e:e.els.lbl.m;case m.Bool:return e.els.lbl.b;case m.Enum:return e.els.lbl.e;
default:throw Error("CL45");}},Ja=function(a){var b=h(a.getAttribute("ce202"))?w(a):null;return b==d.Setter||b==d.Action?!0:b==d.Flow?!1:h(a.previousSibling)?Ja(a.previousSibling):!1},Kc=function(a,b,c){if(!h(a)||!h(a.ps))return null;for(var d=c;d<=a.ps.length;d++)if(a.ps[d].o==b)return a.ps[d];return 0<c?Kc(a,b,0):null},wb=function(a,b){var c=w(a),g=K(a);return a.getAttribute&&h(a.getAttribute("ce204"))&&(c==d.Function||c==d.Action||c==d.Calculation&&(g==n.Name||g==n.End))&&g==b?a:h(a.previousSibling)?
wb(a.previousSibling,b):null},ic=function(a,b){var c=w(a),g=K(a);return a.getAttribute&&h(a.getAttribute("ce204"))&&(c==d.Function||c==d.Action||c==d.Calculation&&(g==n.Name||g==n.End))&&g==b?a:h(a.nextSibling)?ic(a.nextSibling,b):null},lc=function(a,b){return h(a)?a.getAttribute&&h(a.getAttribute("ce202"))&&w(a)==b?a:h(a.previousSibling)?lc(a.previousSibling,b):null:null},Da=function(a){return h(a)?h(a.getAttribute)&&h(a.getAttribute("ce202"))&&(w(a)==d.Field||(w(a)==d.Function||w(a)==d.Action)&&
K(a)==n.Name||w(a)==d.Calculation&&K(a)==n.Name)?a:h(a.previousSibling)?Da(a.previousSibling):null:null},hd=function(a){if(!h(a))return null;if(h(a.getAttribute)&&h(a.getAttribute("ce202"))){var b=w(a);if(b==d.RightSource||b==d.LeftSource)return a;if(h(a.previousSibling))return hd(a.previousSibling)}return null},Xa=function(a,b){return h(a)?h(a.getAttribute)&&h(a.getAttribute("ce202"))&&w(a)==b?a:h(a.nextSibling)?Xa(a.nextSibling,b):null:null},Mb=function(a){return a.getAttribute&&h(a.getAttribute("ce202"))&&
w(a)!=d.HtmlTag?a:h(a.nextSibling)?Mb(a.nextSibling):null},ca=function(a){return zb(a)?a:h(a.previousSibling)?ca(a.previousSibling):null},Ba=function(a){return zb(a)?a:h(a.nextSibling)?Ba(a.nextSibling):null},tb=function(a,b){if(!h(a))return null;var c=K(a);return c==n.End?null:c==n.Param&&ha(a,!0)==b?a:h(a.nextSibling)?tb(a.nextSibling,b):null},Ac=function(){P=[];if(h(e.els.lbl.y)){var a=new l.Menu.Item;a.ID="ceEval";a.Name=e.els.lbl.y;P.push(a)}h(e.els.lbl.x)&&(a=new l.Menu.Item,a.ID="ceExec",a.Name=
e.els.lbl.x,P.push(a));if(h(e.els.rls))for(var b=0;b<e.els.rls.length;b++)a=new l.Menu.Item,a.ID=e.els.rls[b].v||e.els.rls[b].ID,a.Name=e.els.rls[b].n||e.els.rls[b].Name,P.push(a)},Ua=function(a,b){if(!b){var d=wb(a,n.Name);La=d.id;c=I(d)}c=c.nextSibling},N=function(a){x=null;var b=e.els.src[0].n;h(a)&&(a=hd(a),h(a)&&(b=a.getAttribute("ce208")));for(a=0;a<e.els.src.length;a++)if(e.els.src[a].n==b){x=e.els.src[a];h(x.fds)&&x.fds.length||(x.fds=[]);h(x.acs)&&x.acs.length||(x.acs=[]);if(!h(x.references))for(x.references=
!1,a=0;a<x.fds.length;a++)if(b=x.fds[a],b.t==d.Field&&b.o==m.Collection&&b.ct==B.Reference){x.references=!0;break}break}if(!h(x))throw Error("CL91");},I=function(a){if(h(a)){if(h(La)){var b=document.getElementById(La);h(b)&&(b.className=$rule.trim(b.className.replace(e.currentBg,"")))}h(c)&&(c.className=$rule.trim(c.className.replace(e.currentBg,"").replace(e.highlightBg,"")));"INPUT"!=a.tagName&&0>a.className.indexOf(e.currentBg)&&(a.className=a.className+" "+e.currentBg);return a}},sa=function(a){var b=
w(a),c=K(a);return b==d.Function||b==d.Action||b==d.Calculation&&(c==n.Name||c==n.End)?(a=fa(a),h(a)&&h(a.ps)?0==a.ps.length:!0):!1},zb=function(a){return a.getAttribute&&h(a.getAttribute("ce202"))?(a=w(a),a!=d.Tab&&a!=d.NewLine&&a!=d.HtmlTag):!1},gb=function(a,b,c,e){return a==d.Value&&(b==m.String||b==m.Numeric)||a==d.Calculation&&c==p.Number||(a==d.Function||a==d.Action)&&e==q.Input&&(b==m.String||b==m.Numeric)},qa=function(a){return 31<a&&40>a||41<a&&60>a||61==a||63<a&&91>a||96<a&&123>a||222<
a},Mc=function(){for(var a=Ma(),b=0;b<a.length;b++)switch(w(a[b])){case d.Clause:case d.Function:case d.Field:case d.Operator:case d.Value:case d.Action:case d.LeftParenthesis:case d.RightParenthesis:case d.Calculation:return!0}return!1},aa=function(){fc();ja||va();3==r?T.position():4==r?Ca.position():(6==r||8==r)&&xa()},W=function(){if(h(c.nextSibling)){if(e.right){var a=w(c.nextSibling);return a!=d.NewLine&&a!=d.Tab}return!1}return!0},Qb=function(){if(h(c.nextSibling))for(c=c.nextSibling;h(c.nextSibling)&&
!zb(c.nextSibling);){var a=c.nextSibling;y.container.removeChild(c);c=a}$a()},Cc=function(a){Yb&&8<l.Client.version&&window.Modernizr&&3>Xb?Xb++:(ra=0,1!=r&&2!=r&&aa())},wd=function(){if(ba){6!=r&&8!=r||xa();var a=w(c);a!=d.NewLine&&a!=d.Tab?eb(!1):aa()}},xa=function(){Wb=0;D="";z=[];ua.close();r=0},Hb=function(a){a=$rule.getChildrenByAttribute(document.body,"class",a);if(h(a)&&0<a.length)for(var b=0,c,d=a.length;b<d;b++)c=a[b],h(c.parentNode)&&c.parentNode.removeChild(c)},Hc=function(){y.container.innerHTML=
"";var a=document.createElement("SPAN");a.className=e.emptyColor;a.style.paddingBottom="2px";a.style.display="inline-block";a.style.whiteSpace="nowrap";a.style.cursor="default";a.innerHTML=e.els.lbl.g;y.container.appendChild(a);c=null},Ic=function(){h(y.container)&&(y.container.innerHTML="",y.container.style.color="")},Nb=function(a){if(l.getScrollHeight()>a)try{window.scroll(l.getScrollWidth(),a)}catch(g){}},kc=function(a,b){var c=l.getWindowDimensions().height,d=l.getScrollHeight();if(c+d<a+b)try{window.scroll(l.getScrollWidth(),
d+(a+b-(c+d)))}catch(J){}},ub=function(a){return String(a).replace(/\\/g,"\\\\").replace(/'/g,"'").replace(/"/g,"&quot;")},nb=function(a){return String(a).replace(/&#92;/g,"\\").replace(/&#39;/g,"'").replace(/&quot;/g,'"')},Yc=function(a){return h(a)?a.replace("+","$"):a},ha=function(a,b){var d=parseInt(a.getAttribute("ce209"),10);return d!=m.Collection||b?d:E(x.fds,Da(c).getAttribute("ce208")).co},ya=function(a,b){h(b)&&0<b.length&&(a.className=Z(b))},Cb=function(a){return"true"==a?e.els.lbl.t:e.els.lbl.f},
Z=function(a){return l.defined(a)?a:""},va=function(a,b){if(e.help)if(Y.className=Z(e.helpCss),h(b)){var c=e.els.ms[a].replace("{0}",b);hb(c)}else hb(e.els.ms[h(a)?a:Ed()])},Ka=function(a){return h(a)&&a.getAttribute&&"if"==a.getAttribute("ce208")},Ma=function(){return l.getChildrenByTagName(y.container,"SPAN",!1)},Ob=function(a){if(h(c)){var b=c,d=!1;do{"true"==b.getAttribute("ce218")?(b.className=$rule.trim(b.className.replace(e.selectedBg,"")),b.setAttribute("ce218","false")):(b.className=l.trim(b.className)+
" "+e.selectedBg,b.setAttribute("ce218","true"),d=!0);if(b.id==ta)break;b=a?b.previousSibling:b.nextSibling}while(h(b)&&b.id!=ta);h(b)&&(b.className=$rule.trim(b.className.replace(e.selectedBg,"")),b.setAttribute("ce218","false"),d&&(b.className=l.trim(b.className)+" "+e.selectedBg,b.setAttribute("ce218","true")))}},w=function(a){return parseInt(a.getAttribute("ce202"),10)},V=function(a){return parseInt(a.getAttribute("ce203"),10)},K=function(a){return parseInt(a.getAttribute("ce204"),10)},za=function(a){return parseInt(a.getAttribute("ce205"),
10)},jb=function(){T.hide()},ib=function(){Ca.hide()},jd=function(a){return pd(a)},ld=function(a){return rd(a)},kd=function(a){return qd(a)},id=function(a){od(a)},hb=function(a){h(Y)&&h(a)&&(Y.innerHTML=a)},qb=function(a){e.help&&(h(a)||(a="--------------"),hb(a),h(Y)&&(Y.className=Y.className+" "+Z(e.warningColor)))}};